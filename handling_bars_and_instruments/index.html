<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../favicon.ico">
  
  <title>Handling bars and instruments - AgenaScript Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../custom.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Handling bars and instruments";
    var mkdocs_page_input_path = "handling_bars_and_instruments.md";
    var mkdocs_page_url = "/handling_bars_and_instruments/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-74646070-1', 'agenatrader.github.io');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> AgenaScript Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Lets start</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Handling bars and instruments</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#handling-bars-and-instruments">Handling bars and instruments</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#bars">Bars</a></li>
        
            <li><a class="toctree-l3" href="#properties">Properties</a></li>
        
            <li><a class="toctree-l3" href="#barscount">Bars.Count</a></li>
        
            <li><a class="toctree-l3" href="#barscurrentsessionbegintime">Bars.CurrentSessionBeginTime</a></li>
        
            <li><a class="toctree-l3" href="#barscurrentsessionendtime">Bars.CurrentSessionEndTime</a></li>
        
            <li><a class="toctree-l3" href="#barsgetbar">Bars.GetBar</a></li>
        
            <li><a class="toctree-l3" href="#barsgetbarindex">Bars.GetBarIndex</a></li>
        
            <li><a class="toctree-l3" href="#barsgetbarsago">Bars.GetBarsAgo</a></li>
        
            <li><a class="toctree-l3" href="#barsgetbyindex">Bars.GetByIndex</a></li>
        
            <li><a class="toctree-l3" href="#barsgetclose">Bars.GetClose</a></li>
        
            <li><a class="toctree-l3" href="#barsgethigh">Bars.GetHigh</a></li>
        
            <li><a class="toctree-l3" href="#barsgetlow">Bars.GetLow</a></li>
        
            <li><a class="toctree-l3" href="#barsgetnextsessiontimespan">Bars.GetNextSessionTimeSpan</a></li>
        
            <li><a class="toctree-l3" href="#barsgetopen">Bars.GetOpen</a></li>
        
            <li><a class="toctree-l3" href="#barsgetsessionbegin">Bars.GetSessionBegin</a></li>
        
            <li><a class="toctree-l3" href="#barsgettime">Bars.GetTime</a></li>
        
            <li><a class="toctree-l3" href="#barsgetvolume">Bars.GetVolume</a></li>
        
            <li><a class="toctree-l3" href="#barsinstrument">Bars.Instrument</a></li>
        
            <li><a class="toctree-l3" href="#barsiseod">Bars.IsEod</a></li>
        
            <li><a class="toctree-l3" href="#barsisfalling">Bars.IsFalling</a></li>
        
            <li><a class="toctree-l3" href="#barsisfirstbarinsession">Bars.IsFirstBarInSession</a></li>
        
            <li><a class="toctree-l3" href="#barsisgrowing">Bars.isGrowing</a></li>
        
            <li><a class="toctree-l3" href="#barsisintraday">Bars.IsIntraday</a></li>
        
            <li><a class="toctree-l3" href="#barsisntb">Bars.IsNtb</a></li>
        
            <li><a class="toctree-l3" href="#barsissessionbreak">Bars.IsSessionBreak</a></li>
        
            <li><a class="toctree-l3" href="#barslastbarcompleteness">Bars.LastBarCompleteness</a></li>
        
            <li><a class="toctree-l3" href="#barsnextsessionbegintime">Bars.NextSessionBeginTime</a></li>
        
            <li><a class="toctree-l3" href="#barsnextsessionendtime">Bars.NextSessionEndTime</a></li>
        
            <li><a class="toctree-l3" href="#barstailbottom">Bars.TailBottom</a></li>
        
            <li><a class="toctree-l3" href="#barstailtop">Bars.TailTop</a></li>
        
            <li><a class="toctree-l3" href="#barstickscountforlastbar">Bars.TicksCountForLastBar</a></li>
        
            <li><a class="toctree-l3" href="#barstickscountintotal">Bars.TicksCountInTotal</a></li>
        
            <li><a class="toctree-l3" href="#barstimeframe">Bars.TimeFrame</a></li>
        
            <li><a class="toctree-l3" href="#barscountforsession">BarsCountForSession</a></li>
        
            <li><a class="toctree-l3" href="#processingbarindexlast">ProcessingBarIndexLast</a></li>
        
            <li><a class="toctree-l3" href="#collections">Collections</a></li>
        
            <li><a class="toctree-l3" href="#chartdrawings">ChartDrawings</a></li>
        
            <li><a class="toctree-l3" href="#inseries">InSeries</a></li>
        
            <li><a class="toctree-l3" href="#lines">Lines</a></li>
        
            <li><a class="toctree-l3" href="#plotcolors">PlotColors</a></li>
        
            <li><a class="toctree-l3" href="#outputdescriptor">OutputDescriptor</a></li>
        
            <li><a class="toctree-l3" href="#values">Values</a></li>
        
            <li><a class="toctree-l3" href="#data-series">Data Series</a></li>
        
            <li><a class="toctree-l3" href="#open">Open</a></li>
        
            <li><a class="toctree-l3" href="#opens">Opens</a></li>
        
            <li><a class="toctree-l3" href="#high">High</a></li>
        
            <li><a class="toctree-l3" href="#highs">Highs</a></li>
        
            <li><a class="toctree-l3" href="#low">Low</a></li>
        
            <li><a class="toctree-l3" href="#lows">Lows</a></li>
        
            <li><a class="toctree-l3" href="#close">Close</a></li>
        
            <li><a class="toctree-l3" href="#closes">Closes</a></li>
        
            <li><a class="toctree-l3" href="#median">Median</a></li>
        
            <li><a class="toctree-l3" href="#medians">Medians</a></li>
        
            <li><a class="toctree-l3" href="#typical">Typical</a></li>
        
            <li><a class="toctree-l3" href="#typicals">Typicals</a></li>
        
            <li><a class="toctree-l3" href="#weighted">Weighted</a></li>
        
            <li><a class="toctree-l3" href="#weighted_1">Weighted</a></li>
        
            <li><a class="toctree-l3" href="#weighteds">Weighteds</a></li>
        
            <li><a class="toctree-l3" href="#time">Time</a></li>
        
            <li><a class="toctree-l3" href="#times">Times</a></li>
        
            <li><a class="toctree-l3" href="#volume">Volume</a></li>
        
            <li><a class="toctree-l3" href="#volumes">Volumes</a></li>
        
            <li><a class="toctree-l3" href="#timeframe">TimeFrame</a></li>
        
            <li><a class="toctree-l3" href="#timeframes">TimeFrames</a></li>
        
            <li><a class="toctree-l3" href="#instruments">Instruments</a></li>
        
            <li><a class="toctree-l3" href="#instrumentcompare">Instrument.Compare</a></li>
        
            <li><a class="toctree-l3" href="#instrumentcurrency">Instrument.Currency</a></li>
        
            <li><a class="toctree-l3" href="#instrumentdigits">Instrument.Digits</a></li>
        
            <li><a class="toctree-l3" href="#instrumentetf">Instrument.ETF</a></li>
        
            <li><a class="toctree-l3" href="#instrumentexchange">Instrument.Exchange</a></li>
        
            <li><a class="toctree-l3" href="#instrumentexpiry">Instrument.Expiry</a></li>
        
            <li><a class="toctree-l3" href="#instrumentgetcurrencyfactor">Instrument.GetCurrencyFactor</a></li>
        
            <li><a class="toctree-l3" href="#instrumentinstrumenttype">Instrument.InstrumentType</a></li>
        
            <li><a class="toctree-l3" href="#instrumentmainsector">Instrument.MainSector</a></li>
        
            <li><a class="toctree-l3" href="#instrumentmargin">Instrument.Margin</a></li>
        
            <li><a class="toctree-l3" href="#instrumentname">Instrument.Name</a></li>
        
            <li><a class="toctree-l3" href="#instrumentpointvalue">Instrument.PointValue</a></li>
        
            <li><a class="toctree-l3" href="#instrumentround2ticksize">Instrument.Round2TickSize</a></li>
        
            <li><a class="toctree-l3" href="#instrumentsymbol">Instrument.Symbol</a></li>
        
            <li><a class="toctree-l3" href="#instrumentticksize">Instrument.TickSize</a></li>
        
            <li><a class="toctree-l3" href="#multibars">Multibars</a></li>
        
            <li><a class="toctree-l3" href="#processingbarindexes">ProcessingBarIndexes</a></li>
        
            <li><a class="toctree-l3" href="#processingbarseriesindex">ProcessingBarSeriesIndex</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../events/">Events</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../strategy_programming/">Strategy programming</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../keywords/">Keywords</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../drawing_objects/">Drawing objects</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../hints_and_advice/">Hints and advice</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">AgenaScript Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Handling bars and instruments</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/AgenaTrader/AgenaScript-documentation/edit/master/sources/handling_bars_and_instruments.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="handling-bars-and-instruments">Handling bars and instruments</h1>
<p>Data is understood as information that is retrieved externally and uploaded to AgenaTrader, or as data series that are created by AgenaScripts.</p>
<p>Further detailed information can be found using the appropriate shortcuts:</p>
<p><a href="#bars">Bars</a></p>
<p><a href="#collections">Collections</a></p>
<p><a href="#data-series">Data series</a></p>
<p><a href="#instruments">Instruments</a></p>
<p><a href="#multibars">Multibars</a></p>
<h2 id="bars">Bars</h2>
<h3 id="functionality">Functionality</h3>
<p>A classical indicator calculates one or multiple values using an existing data series.</p>
<p>Data series can be anything from closing prices to daily lows or values of an hourly period etc.</p>
<p>Every period (meaning all candles of one day, one hour etc.) is assigned one or more indicator values.
The following example is based on an indicator value, such as with a moving average, for example.
To calculate a smoothed moving average, AgenaTrader needs a data series. In this example we will use the closing prices. All closing prices of a bar (candle) that are represented in the chart will be saved in a list and indexed.</p>
<p>The current closing price, meaning the closing price of the bar that is on the right-hand side of the chart, will be assigned an index of 0. The bar to the left of that will have an index of 1 and so on. The oldest bar displayed will have an index value of 500.</p>
<p>Whenever a new bar is added within a session it will become the new index 0; the bar to the left of it, which previously had an index of 0, will become index 1 and so on. The oldest bar will become index 501.
Within a script (a self-created program/algorithm) the <a href="#close"><em>Close</em></a> will be representative for the array (list) of all closing prices.
The last closing price is thus <em>Close [0]</em>; the closing price previous to this will become <em>Close [1]</em>, the value before that will become <em>Close [2]</em> and the oldest bar will be <em>Close [501]</em>. The number within the squared brackets represents the index. AgenaTrader allows you to use the „bars ago" expression for this in general cases.</p>
<p>Obviously, every bar will not only have a closing value but also a <a href="#high"><em>High</em></a>, <a href="#low"><em>Low</em></a>, <a href="#open"><em>Open</em></a>, <a href="#median"><em>Median</em></a>, <a href="#typical"><em>Typical</em></a>, <a href="#weighted"><em>Weighted</em></a>, <a href="#time"><em>Time</em></a> and <a href="#volume"><em>Volume</em></a>. Thus, the high of the candle that occurred 10 days ago will be <em>High [10]</em>, yesterday’s low <em>Low [1]</em>...</p>
<p><strong>Important tip:</strong></p>
<p>The previous examples all assume that the calculations will occur at the end of a period. The value of the currently running index is not being taken into consideration.</p>
<p>If you wish to use the values of the currently forming candle then you will need to set the value of</p>
<p><a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a> to „false".</p>
<p>In this case the currently running bar will have the value 0, the bar next to the current bar will have the value 1 and so on. The oldest bar (as in the example above) would now have the value 502.</p>
<p>With close [0] you would receive the most recent value of the last price that your data provider transmitted to AgenaTrader. All values of the bar (high [0], low [0]…) may still change as long as the bar is not yet finished/closed and a new bar has not yet started. Only the open [0] value will not change.</p>
<h2 id="properties">Properties</h2>
<h3 id="properties-of-bars">Properties of Bars</h3>
<p>"Bars" represents a list of all bars (candles) within a chart (see <a href="#functionality"><em>Functionality</em></a>, <a href="#bars"><em>Bars</em></a>).</p>
<p>Bars (<strong>public</strong> IBars Bars) can be used directly in a script and equates to BarsArray [0] (see Bars.GetNextSessionTimeSpan for more information).</p>
<p>The list of bars itself has many properties that can be used in AgenaScript. Properties are always indicated by a dot before the objects (in this case bars, list of candles).</p>
<p><a href="#barscount"><em>Bars.Count</em></a></p>
<p><a href="#barscurrentsessionbegintime"><em>Bars.CurrentSessionBeginTime</em></a></p>
<p><a href="#barscurrentsessionendtime"><em>Bars.CurrentSessionEndTime</em></a></p>
<p><a href="#barsgetbar"><em>Bars.GetBar</em></a></p>
<p><a href="#barsgetbarindex"><em>Bars.GetBarIndex</em></a></p>
<p><a href="#barsgetbarsago"><em>Bars.GetBarsAgo</em></a></p>
<p><a href="#barsgetbyindex"><em>Bars.GetByIndex</em></a></p>
<p><a href="#barsgetclose"><em>Bars.GetClose</em></a></p>
<p><a href="#barsgethigh"><em>Bars.GetHigh</em></a></p>
<p><a href="#barsgetlow"><em>Bars.GetLow</em></a></p>
<p><a href="#barsgetnextsessiontimespan"><em>Bars.GetNextSessionTimeSpan</em></a></p>
<p><a href="#barsgetopen"><em>Bars.GetOpen</em></a></p>
<p><a href="#barsgetsessionbegin"><em>Bars.GetSessionBegin</em></a></p>
<p><a href="#barsgettime"><em>Bars.GetTime</em></a></p>
<p><a href="#barsgetvolume"><em>Bars.GetVolume</em></a></p>
<p><a href="#barsinstrument"><em>Bars.Instrument</em></a></p>
<p><a href="#barsiseod"><em>Bars.IsEod</em></a></p>
<p><a href="#barsisfalling"><em>Bars.IsFalling</em></a></p>
<p><a href="#barsfirstbarinsession"><em>Bars.IsFirstBarInSession</em></a></p>
<p><a href="#barsisgrowing"><em>Bars.IsGrowing</em></a></p>
<p><a href="#barsisintraday"><em>Bars.IsIntraday</em></a></p>
<p><a href="#barsisntb"><em>Bars.IsNtb</em></a></p>
<p><a href="#barssessionbreak"><em>Bars.SessionBreak</em></a></p>
<p><a href="#barslastbarcompleteness"><em>Bars.LastBarCompleteness</em></a></p>
<p><a href="#barsnextsessionbegintime"><em>Bars.NextSessionBeginTime</em></a></p>
<p><a href="#barsnextsessionendtime"><em>Bars.NextSessionEndTime</em></a></p>
<p><a href="#barstailbottom"><em>Bars.TailBottom</em></a></p>
<p><a href="#barstailtop"><em>Bars.TailTop</em></a></p>
<p><a href="#barstickscountforlastbar"><em>Bars.TicksCountForLastBar</em></a></p>
<p><a href="#barstickscountintotal"><em>Bars.TicksCountInTotal</em></a></p>
<p><a href="#barstimeframe"><em>Bars.TimeFrame</em></a></p>
<p><a href="#barscountforsession"><em>BarsCountForSession</em></a></p>
<p><a href="#isprocessingbarindexlast"><em>IsProcessingBarIndexLast</em></a></p>
<p>With the <strong>OnCalculate()</strong> method you can use any properties you want without having to test for a null reference.
As soon as the function <strong>OnCalculate()</strong> is called up by AgenaScript, it is assumed that an object is also available. If you wish to use these properties outside of <strong>OnCalculate()</strong> then you should first perform a test for null references using <strong>if</strong> (Bars != <strong>null</strong>).</p>
<h2 id="barscount">Bars.Count</h2>
<h3 id="description">Description</h3>
<p>Bars.Count gives you the amount of bars in a data series.</p>
<p>See <a href="#properties"><em>Properties</em></a> for additional information.</p>
<h3 id="return-value">Return Value</h3>
<p>Type int Amount of Bars</p>
<h3 id="usage">Usage</h3>
<p>Bars.Count</p>
<h3 id="more-information">More Information</h3>
<p>The value of <em>ProcessingBarIndex</em> can only be lesser than or equal to Bars.Count - 1</p>
<p>When you specify how many bars are to be loaded within AgenaTrader, then the value of Bars.Count is equal to this setting. In the following example, Bars.Count would give back a value of 500.</p>
<p><img alt="Bars.Count" src="../media/image1.png" /></p>
<h3 id="example">Example</h3>
<pre><code class="cs">Print (&quot;There are a total of&quot; + Bars.Count + &quot;bars available.&quot;);
</code></pre>

<h2 id="barscurrentsessionbegintime">Bars.CurrentSessionBeginTime</h2>
<h3 id="description_1">Description</h3>
<p>Bars.CurrentSessionBeginTime outputs the date and time for the beginning of the current trading session.</p>
<p>Date and time for the beginning of the current trading session will be displayed correctly when the function is used on a bar that has occurred in the past.</p>
<h3 id="parameter">Parameter</h3>
<p>None</p>
<h3 id="return-value_1">Return Value</h3>
<p>Type DateTime</p>
<h3 id="usage_1">Usage</h3>
<p>Bars.GetSessionBegin</p>
<h3 id="more-information_1">More Information</h3>
<p>The time for the returned value will equal the starting time defined in the Market Escort for the specified exchange. The value itself is set within the Instrument Escort and can be called up in AgenaScript using the function <a href="#instrumentexchange"><em>Instrument.Exchange</em></a> .</p>
<p><img alt="Bars.CurrentSessionBeginTime" src="../media/TradingHour_TSE.jpg" /></p>
<h3 id="example_1">Example</h3>
<pre><code class="cs">Print(&quot;The currently running trading session started at &quot; + Bars.CurrentSessionBeginTime );
</code></pre>

<h2 id="barscurrentsessionendtime">Bars.CurrentSessionEndTime</h2>
<h3 id="description_2">Description</h3>
<p>Bars.CurrentSessionEndTime outputs the time for the end of the currently running trading session.
Date and time for the end of the current trading session will, in this case, also be outputted correctly when the function is used on a previous bar.</p>
<h3 id="parameter_1">Parameter</h3>
<p>None</p>
<h3 id="return-value_2">Return Value</h3>
<p>Type DateTime</p>
<h3 id="usage_2">Usage</h3>
<p>Bars.GetSessionEnd</p>
<h3 id="more-information_2">More Information</h3>
<p>The time for the returned value will correlate with the end time of the trading session defined in the Market Escort for the exchange. The value itself can be set within the Instrument Escort and can be called up with AgenaScript using the <a href="#instrumentexchange"><em>Instrument.Exchange</em></a> function.</p>
<p><img alt="Bars.CurrentSessionEndTime" src="../media/TradingHour_Nashdaq.jpg" /></p>
<h3 id="example_2">Example</h3>
<pre><code class="cs">Print(&quot;The current trading session will end at &quot; + Bars.CurrentSessionEndTime);
</code></pre>

<h2 id="barsgetbar">Bars.GetBar</h2>
<h3 id="description_3">Description</h3>
<p>Bars.GetBar outputs the first bars (from oldest to newest) that correspond to the specified date/time.</p>
<p>See <a href="#barsgetbarsago"><em>Bars.GetBarsAgo</em></a>, <a href="#barsgetbyindex"><em>Bars.GetByIndex</em></a>, <a href="#barsgetbarindex"><em>Bars.GetBarIndex</em></a>.</p>
<h3 id="parameter_2">Parameter</h3>
<p>Type DateTime</p>
<h3 id="return-value_3">Return Value</h3>
<p>Type IBar Bar Object, for the bars corresponding to the timestamp</p>
<p>For a timestamp older than the oldest bar: 0 (null)
For a timestamp younger than the newest bar: index of the last bar</p>
<h3 id="usage_3">Usage</h3>
<pre><code class="cs">Bars.GetBar(DateTime time)
</code></pre>

<h3 id="more-information_3">More Information</h3>
<p>For the indexing of bars please see <a href="#functionality"><em>Functionality</em></a>, <a href="#bars"><em>Bars</em></a></p>
<p>For more information about using DateTime see <a href="http://msdn.microsoft.com/de-de/library/system.datetime.aspx">http://msdn.microsoft.com/de-de/library/system.datetime.aspx</a></p>
<h3 id="example_3">Example</h3>
<pre><code class="cs">Print (&quot;The closing price for 01.03.2012 at 18:00:00 was &quot; + Bars.GetBar(new DateTime(2012, 01, 03, 18, 0, 0)).Close);
</code></pre>

<h2 id="barsgetbarindex">Bars.GetBarIndex</h2>
<h3 id="description_4">Description</h3>
<p>Bars.GetBarIndex outputs the index of a bar – you can input either a bar object or a date-time object using this method.</p>
<p>See <a href="#barsgetbar"><em>Bars.GetBar</em></a>, <a href="#barsgetbarsago"><em>Bars.GetBarsAgo</em></a>, <a href="#barsgetbyindex"><em>Bars.GetByIndex</em></a>.</p>
<h3 id="parameter_3">Parameter</h3>
<p>Type IBar bar
or
Type DateTime</p>
<h3 id="return-value_4">Return Value</h3>
<p>Type int The bar index of the specified bar object or DateTime object</p>
<h3 id="usage_4">Usage</h3>
<pre><code class="cs">Bars.GetBarIndex (IBar bar)
Bars.GetBarIndex (DateTime dt)
</code></pre>

<h3 id="more-information_4">More Information</h3>
<p>For more information about indexing see <a href="#functionality"><em>Functionality</em></a>, <a href="#bars"><em>Bars</em></a></p>
<h3 id="example_4">Example</h3>
<pre><code class="cs">int barsAgo = 5;
IBar bar = Bars.GetBar(Time[barsAgo]);
Print(barsAgo + &quot; and &quot; + Bars.GetBarIndex(bar) + &quot; are equal in this example.&quot;);
</code></pre>

<h2 id="barsgetbarsago">Bars.GetBarsAgo</h2>
<h3 id="description_5">Description</h3>
<p>Bars.GetBarsAgo outputs the index of the first bars (from oldest to newest) that correspond to the specified date/time.</p>
<p>See: <a href="#barsgetbar"><em>Bars.GetBar</em></a>, <a href="#barsgetbyindex"><em>Bars.GetByIndex</em></a>, <a href="#barsgetbarindex"><em>Bars.GetBarIndex</em></a>.</p>
<h3 id="parameter_4">Parameter</h3>
<p>Type DateTime</p>
<h3 id="return-value_5">Return Value</h3>
<p>Type int Index of the bar that corresponds to the timestamp</p>
<p>With a timestamp older than the oldest bar: 0 (null)
With a timestamp newer than the youngest bar: index of the last bar</p>
<h3 id="usage_5">Usage</h3>
<pre><code class="cs">Bars.GetBarsAgo(DateTime time)
</code></pre>

<h3 id="more-information_5">More Information</h3>
<p>For more information about indexing please see <a href="#functionality"><em>Functionality</em></a>, <a href="#bars"><em>Bars</em></a></p>
<p>For more information about using DateTime see <a href="http://msdn.microsoft.com/de-de/library/system.datetime.aspx">http://msdn.microsoft.com/de-de/library/system.datetime.aspx</a></p>
<h3 id="example_5">Example</h3>
<pre><code class="cs">Print(&quot;The bar for 01.03.2012 at 18:00:00 O’clock has an index of &quot; + Bars.GetBarsAgo(new DateTime(2012, 01, 03, 18, 0, 0)));
</code></pre>

<h2 id="barsgetbyindex">Bars.GetByIndex</h2>
<h3 id="description_6">Description</h3>
<p>Bars.GetByIndex outputs the index for the specified bar object</p>
<p>See <a href="#barsgetbar"><em>Bars.GetBar</em></a>, <a href="#barsgetbarsago"><em>Bars.GetBarsAgo</em></a>, <a href="#barsgetbarindex"><em>Bars.GetBarIndex</em></a>.</p>
<h3 id="parameter_5">Parameter</h3>
<p>Type int Index</p>
<h3 id="return-value_6">Return Value</h3>
<p>Type IBar Bar object for the specified index</p>
<h3 id="usage_6">Usage</h3>
<pre><code class="cs">Bars.GetByIndex (int Index)
</code></pre>

<h3 id="more-information_6">More Information</h3>
<p>For indexing of bars see <a href="#functionality"><em>Functionality</em></a>, <a href="#bars"><em>Bars</em></a></p>
<h3 id="example_6">Example</h3>
<pre><code class="cs">Print(Close[0] + &quot; and &quot; + Bars.GetByIndex(ProcessingBarIndex).Close + &quot; are equal in this example.&quot;);
</code></pre>

<h2 id="barsgetclose">Bars.GetClose</h2>
<p>Bars.GetClose(int index) – see <a href="#barsgetopen"><em>Bars.GetOpen</em></a>.</p>
<h2 id="barsgethigh">Bars.GetHigh</h2>
<p>Bars.GetHigh(int index) – see <a href="#barsgetopen"><em>Bars.GetOpen</em></a>.</p>
<h2 id="barsgetlow">Bars.GetLow</h2>
<p>Bars.GetLow(int index) – see <a href="#barsgetopen"><em>Bars.GetOpen</em></a>.</p>
<h2 id="barsgetnextsessiontimespan">Bars.GetNextSessionTimeSpan</h2>
<h3 id="description_7">Description</h3>
<p>Bars.GetNextSessionTimeSpan outputs the date and time for the beginning and end of a trading session.</p>
<p>See <a href="#barscurrentsessionbegintime"><em>Bars.CurrentSessionBeginTime</em></a>, <a href="#barscurrentsessionendtime"><em>Bars.CurrentSessionEndTime</em></a>, <a href="#barsnextsessionbegintime"><em>Bars.NextSessionBeginTime</em></a>, <a href="#barsnextsessionendtime"><em>Bars.NextSessionEndTime</em></a>.</p>
<h3 id="parameter_6">Parameter</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>DateTime</td>
<td>time</td>
<td>Date or time for which the data of the following trading session will be scanned/searched.</td>
</tr>
<tr>
<td>iBars</td>
<td>bars</td>
<td>Bar object for which the data will be scanned/searched.</td>
</tr>
<tr>
<td>int</td>
<td>barsago</td>
<td>Number of days in the past for which the data will be searched/scanned.</td>
</tr>
</tbody>
</table>
<h3 id="return-value_7">Return Value</h3>
<p>DateTime session begin
DateTime session end</p>
<p><strong>Note:</strong>
The date for the beginning and the end of a trading session are connected components. If the specified date corresponds to the end date of the current trading session then the returned value for the beginning of a trading session may already be in the past. In this case the date for the following trading session cannot be returned.</p>
<h3 id="usage_7">Usage</h3>
<pre><code class="cs">Bars.GetNextSessionTimeSpan(Bars bars, int barsAgo, out DateTime sessionBegin, out DateTime sessionEnd)
Bars.GetNextSessionTimeSpan(DateTime time, out DateTime sessionBegin, out DateTime sessionEnd)
</code></pre>

<h3 id="more-information_7">More Information</h3>
<p>The two signatures will not necessarily output the same result.
When using the bar signature, the supplied bar will be inspected for its session template association. The beginning and end of the next session will be taken from this template.</p>
<p>When using the time signature, the date and time of the supplied bar will be used to calculate the data for the current and the following sessions.</p>
<p>When using the time signature, a timestamp is transmitted that corresponds exactly to the beginning or the end time of a session.</p>
<p>More information can be found here <a href="http://msdn.microsoft.com/de-de/library/system.datetime.aspx"><em>http://msdn.microsoft.com/de-de/library/system.datetime.aspx</em></a></p>
<h3 id="example_7">Example</h3>
<pre><code class="cs">DateTime sessionBegin;
DateTime sessionEnd;
protected override void OnCalculate()
{
Bars.GetNextSessionTimeSpan(Bars, 0, out sessionBegin, out sessionEnd);
Print(&quot;Session Start: &quot; + sessionBegin + &quot; Session End: &quot; + sessionEnd);
}
</code></pre>

<h2 id="barsgetopen">Bars.GetOpen</h2>
<h3 id="description_8">Description</h3>
<p>For reasons of compatibility, the following methods are available.</p>
<ul>
<li>Bars.GetOpen(int index) outputs the open for the bars referenced with &lt;index&gt;.</li>
<li>Bars.GetHigh(int index) outputs the high for the bars referenced with &lt;index&gt;.</li>
<li>Bars.GetLow(int index) outputs the low for the bars referenced with &lt;index&gt;.</li>
<li>Bars.GetClose(int index) outputs the close for the bars referenced with &lt;index&gt;.</li>
<li>Bars.GetTime(int index) outputs the timestamp for the bars referenced with &lt;index&gt;.</li>
<li>Bars.GetVolume(int index) outputs the volume for the bars referenced with &lt;index&gt;.</li>
</ul>
<p><strong>Caution</strong>: The indexing will deviate from the <a href="#indexing"><em>Indexing</em></a>, <a href="#bars"><em>Bars</em></a> normally used.
Here, the indexing will begin with 0 for the oldest bar (on the left of the chart) and end with the newest bar on the right of the chart (=Bars.Count-1).</p>
<p>The indexing can easily be recalculated:</p>
<pre><code class="cs">private int Convert(int idx)
{
return Math.Max(0,Bars.Count-idx-1-(CalculateOnClosedBar?1:0));
}
</code></pre>

<h3 id="parameter_7">Parameter</h3>
<p>int index (0 .. Bars.Count-1)</p>
<h3 id="return-value_8">Return Value</h3>
<p>Type double for GetOpen, GetHigh, GetLow, GetClose and GetVolume</p>
<p>Type DateTime for GetTime</p>
<h2 id="barsgetsessionbegin">Bars.GetSessionBegin</h2>
<h3 id="description_9">Description</h3>
<p>Bars.GetSessionBegin provides the date and time of the particular session start. The date and time for the start of the current trading session are also correctly indicated when the function is called from a bar in the past. See also other <a href="#properties"><em>Properties</em></a> of bars.</p>
<h3 id="parameter_8">Parameter</h3>
<p>None</p>
<h3 id="return-value_9">Return value</h3>
<p>Type DateTime</p>
<h3 id="usage_8">Usage</h3>
<p>Bars.GetSessionBegin(DateTime dt)</p>
<h3 id="further-information">Further Information</h3>
<p>The time of the returned value corresponds to the start time of the trading session.  The relevant trading center which is specified in the MarketEscort. The trading place used for the value is set in the Instrumet Escort and can be determined in AgenaSript with the Instrument.Exchange function.</p>
<p><img alt="Bars.CurrentSessionBeginTime" src="../media/TradingHour_TSE.jpg" /></p>
<h3 id="example_8">Example</h3>
<pre><code class="cs">Print(&quot;Die Handelssitzung am 25.03.2015 hat um &quot;+ Bars.GetSessionBegin(new DateTime(2015, 03, 25)) + &quot; begonnen.&quot;);
}
</code></pre>

<h2 id="barsgettime">Bars.GetTime</h2>
<p>Bars.GetTime(int index) – see <a href="#barsgetopen"><em>Bars.GetOpen</em></a>.</p>
<h2 id="barsgetvolume">Bars.GetVolume</h2>
<p>Bars.GetVolume(int index) – see <a href="#barsgetopen"><em>Bars.GetOpen</em></a>.</p>
<h2 id="barsinstrument">Bars.Instrument</h2>
<h3 id="description_10">Description</h3>
<p>Bars.Instrument outputs an instrument object for the trading instrument displayed within the chart.</p>
<p>See <a href="#properties"><em>Properties</em></a> for more information.</p>
<h3 id="parameter_9">Parameter</h3>
<p>None</p>
<h3 id="return-value_10">Return Value</h3>
<p>Type Instrument</p>
<h3 id="usage_9">Usage</h3>
<p>Bars.Instrument</p>
<h3 id="more-information_8">More Information</h3>
<p>For more information regarding the trading instruments please see <a href="#instruments"><em>Instruments</em></a>.</p>
<h3 id="example_9">Example</h3>
<pre><code class="cs">// both outputs will provide the same result
Print(&quot;The currently displayed trading instrument has the symbol: &quot; + Bars.Instrument);
Instrument i = Bars.Instrument;
Print(&quot;The currently displayed trading instrument has the symbol &quot; + i.Symbol);
</code></pre>

<h2 id="barsiseod">Bars.IsEod</h2>
<h3 id="description_11">Description</h3>
<p>Bars.IsEod can be used to check whether they are end-of-day bars.</p>
<p>See <a href="#properties"><em>Properties</em></a> for more information.</p>
<h3 id="parameter_10">Parameter</h3>
<p>None</p>
<h3 id="return-value_11">Return Value</h3>
<p>Type bool</p>
<h3 id="usage_10">Usage</h3>
<p>Bars.IsEod</p>
<h3 id="more-information_9">More Information</h3>
<p>Within <a href="#oncalculate"><em>OnCalculate()</em></a>, this property can be used without having to test for null reference. As soon as the method OnCalculate () is called by AgenaScript, there is always a bar object.</p>
<p>If this property  used outside of OnCalculate (), then a corresponding test should be set to zero reference, e.g. With if (bars! = Null).</p>
<h3 id="example_10">Example</h3>
<pre><code class="cs">Print(&quot;The bars are EOD: &quot; + Bars.IsEod);
</code></pre>

<h2 id="barsisfalling">Bars.IsFalling</h2>
<h3 id="description_12">Description</h3>
<p>Bar properties used when Bar is falling down.</p>
<h3 id="parameter_11">Parameter</h3>
<p>None</p>
<h3 id="return-value_12">Return Value</h3>
<p>None</p>
<h3 id="usage_11">Usage</h3>
<pre><code class="cs">Bars[0].IsFalling;
</code></pre>

<h2 id="barsisfirstbarinsession">Bars.IsFirstBarInSession</h2>
<h3 id="description_13">Description</h3>
<p>With Bars.IsFirstBarInSession you can determine whether the current bar is the first bar of the trading session.</p>
<p>See <a href="#properties"><em>Properties</em></a> of bars for more information.</p>
<h3 id="return-value_13">Return Value</h3>
<p>Type bool</p>
<p><strong>true</strong>: The bar is the first bar of the current trading session
<strong>false</strong>: The bar is not the first bar of the current trading session</p>
<h3 id="usage_12">Usage</h3>
<p>Bars.IsFirstBarInSession</p>
<h3 id="more-information_10">More Information</h3>
<p>With <em>OnCalculate()</em> this property can be used without having to test for a null reference. As soon as the OnCalculate() method is called up, an object will become available.
If this property is called up outside of OnCalculate() you should test for a null reference using if (Bars != null).</p>
<h3 id="example_11">Example</h3>
<pre><code class="cs">if (Bars.IsFirstBarInSession)
Print (&quot;The current trading session started at&quot; + Time [0]);
</code></pre>

<h2 id="barsisgrowing">Bars.isGrowing</h2>
<h3 id="description_14">Description</h3>
<p>Bar properties used when Bar is growing up.</p>
<h3 id="parameter_12">Parameter</h3>
<p>None</p>
<h3 id="return-value_14">Return Value</h3>
<p>None</p>
<h3 id="usage_13">Usage</h3>
<pre><code class="cs">Bars[0].isGrowing;
</code></pre>

<h2 id="barsisintraday">Bars.IsIntraday</h2>
<h3 id="description_15">Description</h3>
<p>Bars.IsIntraday returns a boolean which indicates if the TimeFrame is intra-day.</p>
<h3 id="return-value_15">Return Value</h3>
<p><strong>bool</strong></p>
<p>It returns "true" if TimeFrame is intra-day (e.g. 1 min, 15 min, 1 hour, etc.) and "false" in other cases.</p>
<h3 id="usage_14">Usage</h3>
<pre><code class="cs">Bars.IsIntraday
</code></pre>

<h3 id="example_12">Example</h3>
<pre><code class="cs">if(Bars.IsIntraday) {
    Print(&quot;TimeFrame is Intraday.&quot;);
} else {
    Print(&quot;TimeFrame is not Intraday.&quot;);
}
</code></pre>

<h2 id="barsisntb">Bars.IsNtb</h2>
<h3 id="description_16">Description</h3>
<p>With Bars.IsNtb it can be checked whether it is not-time-based bars. For example Ntb bars are Point &amp; Figure or Renko Charts.</p>
<p>See <a href="#properties"><em>Properties</em></a> for more information.</p>
<h3 id="parameter_13">Parameter</h3>
<p>None</p>
<h3 id="return-value_16">Return Value</h3>
<p>Type bool</p>
<h3 id="usage_15">Usage</h3>
<p>Bars.IsNtb</p>
<h3 id="more-information_11">More Information</h3>
<p><a href="#oncalculate"><em>OnCalculate()</em></a> property can be used without having to test for null reference first. As soon as the method OnCalculate() is called by AgenaScript, there is always a bar object. If this property is used outside of OnCalculate(), then a corresponding test should be set to zero reference, e.g. With if (bars! = Null).</p>
<h3 id="example_13">Example</h3>
<pre><code class="cs">Print(&quot;The bars are Ntb: &quot; + Bars.IsNtb);
</code></pre>

<h2 id="barsissessionbreak">Bars.IsSessionBreak</h2>
<h3 id="description_17">Description</h3>
<p>Bars.IsSessionBreak can be used to determine whether the bars are within the commercial trading session in the commercial breaks defined in the marketplace escort.</p>
<p>See <a href="#properties"><em>Properties</em></a> for more information.</p>
<h3 id="parameter_14">Parameter</h3>
<p>None</p>
<h3 id="return-value_17">Return Value</h3>
<p>Type bool</p>
<h3 id="usage_16">Usage</h3>
<p>Bars.IsSessionBreak</p>
<h3 id="more-information_12">More Information</h3>
<p><img alt="Bars.CurrentSessionEndTime" src="../media/TradingHour_Nashdaq.jpg" /></p>
<h3 id="example_14">Example</h3>
<pre><code class="cs">if (Bars.IsSessionBreak)
{
Print(&quot;The stock exchange Xetra has just a trade pause.&quot;);
}
</code></pre>

<h2 id="barslastbarcompleteness">Bars.LastBarCompleteness</h2>
<h3 id="description_18">Description</h3>
<p>Bars.LastBarCompleteness outputs the value that displays what percentage a bar has already completed. A bar with a period of 10 minutes has completed 50% after 5 minutes.</p>
<p>For non-time-based charts (Kagi, LineBreak, Renko, Range, P&amp;F etc.) this will output 0 during backtesting.</p>
<h3 id="return-value_18">Return Value</h3>
<p><strong>double</strong></p>
<p>A percentage value; 30% will be outputted as 0.3</p>
<h3 id="usage_17">Usage</h3>
<p>Bars.LastBarCompleteness</p>
<h3 id="more-information_13">More Information</h3>
<p>With <a href="#oncalculate"><em>OnCalculate()</em></a> this property can be used without having to test for a null reference. As soon as the OnCalculate() method is called up by AgenaScript, the object will become available.</p>
<p>If this property is used outside of OnCalculate() you should test for a null reference before executing it. You can test using <em>if</em> (Bars != <em>null</em>)</p>
<h3 id="example_15">Example</h3>
<pre><code class="cs">// A 60 minute chart is looked at from an intraday perspective
// every 5 minutes before the current bar closes
// an acoustic signal shall be played
// 55 min. equals 92%
bool remind = false;
protected override void OnCalculate()
{
if (FirstTickOfBar) remind = true;
if (remind &amp;&amp; Bars.LastBarCompleteness &gt;= 0.92)
{
remind = false;
PlaySound(&quot;Alert1&quot;);
}
}
</code></pre>

<h2 id="barsnextsessionbegintime">Bars.NextSessionBeginTime</h2>
<h3 id="description_19">Description</h3>
<p>Bars.NextSessionBeginTime outputs the date and time for the start of the next trading session.
Date and time for the next session will be correctly outputted when the function is used on a bar in the past.</p>
<h3 id="parameter_15">Parameter</h3>
<p>None</p>
<h3 id="return-value_19">Return Value</h3>
<p>Type DateTime</p>
<h3 id="usage_18">Usage</h3>
<p>Bars.GetSessionNextBegin</p>
<h3 id="more-information_14">More Information</h3>
<p>The time for the returned value will correlate to the value displayed in the MarketEscort. The value can be set within the Instrument Escort and can be called up using the <a href="#instrumentexchange"><em>Instrument.Exchange</em></a> function.</p>
<p><img alt="Bars.NextSessionBeginTime" src="../media/TradingHour_TSE.jpg" /></p>
<h3 id="example_16">Example</h3>
<pre><code class="cs">Print(&quot;The next trading session starts at &quot; + Bars.NextSessionBeginTime);
</code></pre>

<h2 id="barsnextsessionendtime">Bars.NextSessionEndTime</h2>
<h3 id="description_20">Description</h3>
<p>Bars.NextSessionEndTime outputs the date and time for the end of the next session.
See <a href="#properties"><em>Properties</em></a> for more information.</p>
<h3 id="parameter_16">Parameter</h3>
<p>None</p>
<h3 id="return-value_20">Return Value</h3>
<p>Type DateTime</p>
<h3 id="usage_19">Usage</h3>
<p>Bars.GetSessionNextEnd</p>
<h3 id="more-information_15">More Information</h3>
<p>The time for the returned value will correlate with the value specified within the MarketEscort. The value itself can be set within the Instrument Escort and can be called up with AgenaScript using the <a href="#instrumentexchange"><em>Instrument.Exchange</em></a> function.</p>
<p><img alt="Bars.NextSessionEndTime" src="../media/TradingHour_Nashdaq.jpg" /></p>
<h3 id="example_17">Example</h3>
<pre><code class="cs">Print(&quot;The next trading session ends at &quot; + Bars.NextSessionEndTime);
</code></pre>

<h2 id="barstailbottom">Bars.TailBottom</h2>
<h3 id="description_21">Description</h3>
<p>With this property you are able to get the height of the bottom candle tail.</p>
<h3 id="parameter_17">Parameter</h3>
<p>None</p>
<h3 id="return-value_21">Return Value</h3>
<p>None</p>
<h3 id="usage_20">Usage</h3>
<pre><code class="cs">Bars[0].TailBottom;
</code></pre>

<h3 id="example_18">Example</h3>
<pre><code class="cs">Print(&quot;The height of the bottom candle tail is: &quot; + Bars.TailBottom);
</code></pre>

<h2 id="barstailtop">Bars.TailTop</h2>
<h3 id="description_22">Description</h3>
<p>With this property you are able to get the height of the top candle tail.</p>
<h3 id="parameter_18">Parameter</h3>
<p>None</p>
<h3 id="return-value_22">Return Value</h3>
<p>None</p>
<h3 id="usage_21">Usage</h3>
<pre><code class="cs">Bars[0].TailTop;
</code></pre>

<h3 id="example_19">Example</h3>
<pre><code class="cs">Print(&quot;The height of the top candle tail is: &quot; + Bars.TailTop);
</code></pre>

<h2 id="barstickscountforlastbar">Bars.TicksCountForLastBar</h2>
<h3 id="description_23">Description</h3>
<p>Bars.TicksCountForLastBar outputs the total numbers of ticks contained within a bar.</p>
<p>More information can be found in <a href="#properties"><em>Properties</em></a> of bars.</p>
<h3 id="parameter_19">Parameter</h3>
<p>None</p>
<h3 id="return-value_23">Return Value</h3>
<p>Type int</p>
<h3 id="usage_22">Usage</h3>
<p>Bars.TicksCountForLastBar</p>
<h3 id="more-information_16">More Information</h3>
<p>With <a href="#oncalculate"><em>OnCalculate()</em></a> this property can be used without having to test for a null reference. As soon as the OnCalculate() method is called up by AgenaScript, the object will become available.</p>
<p>If this property is used outside of OnCalculate(), you should test for a null reference before executing it. You can test using <em>if</em> (Bars != <em>null</em>)</p>
<h3 id="example_20">Example</h3>
<pre><code class="cs">Print(&quot;The current bar consists of &quot; + Bars.TicksCountForLastBar + &quot; Ticks.&quot;);
</code></pre>

<h2 id="barstickscountintotal">Bars.TicksCountInTotal</h2>
<h3 id="description_24">Description</h3>
<p>Bars.TicksCountInTotal outputs the total number of ticks from the moment the function is called up.</p>
<p>More information can be found here: <a href="#properties"><em>Properties</em></a>.</p>
<h3 id="parameter_20">Parameter</h3>
<p>None</p>
<h3 id="return-value_24">Return Value</h3>
<p>Type int</p>
<h3 id="usage_23">Usage</h3>
<p>Bars.TicksCountInTotal</p>
<h3 id="more-information_17">More Information</h3>
<p>The data type int has a positive value range of 2147483647. When you assume 10 ticks per second, there will be no overlaps within 2 trading months with a daily runtime of 24 hours.</p>
<p>With <a href="#oncalculate"><em>OnCalculate()</em></a> this property can be used without having to test for a null reference. As soon as the OnCalculate() method is called up by AgenaScript, the object will become available.</p>
<p>If this property is used outside of OnCalculate(), you should test for a null reference before executing it. You can test using <em>if</em> (Bars != <em>null</em>)</p>
<h3 id="example_21">Example</h3>
<pre><code class="cs">**Print**(&quot;The total amount of ticks is &quot; + Bars.TicksCountInTotal);
</code></pre>

<h2 id="barstimeframe">Bars.TimeFrame</h2>
<h3 id="description_25">Description</h3>
<p>Bars.TimeFrame outputs the timeframe object containing information regarding the currently used timeframe.</p>
<p>More information can be found here: <a href="#properties"><em>Properties</em></a></p>
<h3 id="parameter_21">Parameter</h3>
<p>None</p>
<h3 id="return-value_25">Return Value</h3>
<p>Type ITimeFrame</p>
<h3 id="usage_24">Usage</h3>
<p>Bars.TimeFrame</p>
<h3 id="more-information_18">More Information</h3>
<p>For more information about timeframe objects please see <a href="#timeframe"><em>TimeFrame</em></a>.</p>
<p>With <a href="#oncalculate"><em>OnCalculate()</em></a> this property can be used without having to test for a null reference. As soon as the OnCalculate() method is called up by AgenaScript, the object will become available.</p>
<p>If this property is used outside of OnCalculate(),you should test for a null reference before executing it. You can test using <em>if</em> (Bars != <em>null</em>)</p>
<h3 id="example_22">Example</h3>
<pre><code class="cs">//Usage within a 30 minute chart
TimeFrame tf = (TimeFrame) Bars.TimeFrame;
Print(Bars.TimeFrame); // outputs &quot;30 Min&quot;
Print(tf.Periodicity); // outputs &quot;Minute&quot;
Print(tf.PeriodicityValue); // outputs &quot;30&quot;
</code></pre>

<h2 id="barscountforsession">BarsCountForSession</h2>
<h3 id="description_26">Description</h3>
<p>Bars.BarsCountForSession outputs the amount of bars that have occurred since the beginning of the current trading session.</p>
<p>See further <a href="#properties"><em>Properties</em></a> of bars.</p>
<h3 id="return-value_26">Return Value</h3>
<p>Type int Amount of Bars</p>
<p>A value of -1 indicates a problem with referencing the correct session beginning.</p>
<h3 id="usage_25">Usage</h3>
<p>Bars.BarsCountForSession</p>
<h3 id="further-information_1">Further Information</h3>
<p>Within <em>OnCalculate()</em> this property can be used without having to test for a null reference. As soon as the OnCalculate() method is called up by AgenaScript, the object will become available.</p>
<p>If this property is used outside of OnCalculate() then you should test for a null reference before executing it. You can test using <em>if</em> (Bars!= <em>null</em>) .</p>
<h3 id="example_23">Example</h3>
<pre><code class="cs">Print (&quot;Since the start of the last trading session there have been&quot; + Bars.BarsCountForSession + &quot;bars.&quot;);
</code></pre>

<h2 id="processingbarindexlast">ProcessingBarIndexLast</h2>
<h3 id="description_27">Description</h3>
<p>Indicates if current bar is last in calculation.</p>
<h3 id="parameter_22">Parameter</h3>
<p>none</p>
<h3 id="return-value_27">Return value</h3>
<p>Type bool</p>
<h3 id="usage_26">Usage</h3>
<p>ProcessingBarIndexLast</p>
<h3 id="more-information_19">More Information</h3>
<p>used for complicated calculation on a last bar</p>
<h3 id="example_24">Example</h3>
<pre><code class="cs">protected override void OnCalculate()
        {
            base.OnCalculate();
            if (!IsProcessingBarIndexLast)
                return;
            bool isUpdated;
}
</code></pre>

<h2 id="collections">Collections</h2>
<h2 id="chartdrawings">ChartDrawings</h2>
<h3 id="description_28">Description</h3>
<p>ChartDrawings is a collection containing all drawing objects within the chart. The property hold all drawings which were generated by the script.
The index for ChartDrawings is the explicit name for the drawing object (string tag).</p>
<h3 id="usage_27">Usage</h3>
<p>ChartDrawings [string tag]</p>
<h3 id="example_25">Example</h3>
<p><strong>Note:</strong> To be able to use the interface definitions you must use the using method.</p>
<pre><code class="cs">using AgenaTrader.Plugins;
// Output number of drawing objects within the chart and their tags
Print(&quot;The chart contains &quot; + ChartDrawings.Count + &quot; drawing objects.&quot;);
for each (IDrawObject draw in ChartDrawings) Print(draw.Tag);
//Draw a black trend line...
AddChartLine(&quot;MyLine&quot;, true, 10, Close[10], 0, Close[0], Color.Black, DashStyle.Solid, 3);
// ... and change the color to red
ITrendLine line = (ITrendLine) ChartDrawings[&quot;MyLine&quot;];
if (line != null) line.Pen.Color = Color.Red;
// Set all lines within the chart to a line strength of 3,
// and lock it so that it cannot be edited or moved
foreach (IDrawObject draw in ChartDrawings)
if (draw is IVerticalLine)
{
IVerticalLine vline = (IVerticalLine) draw;
vline.IsLocked = true;
vline.Editable = false;
vline.Pen.Width = 3;
}
</code></pre>

<h2 id="inseries">InSeries</h2>
<h3 id="description_29">Description</h3>
<p>InSeries is a <a href="#dataseries"><em>DataSeries</em></a> object in which the input data for an indicator or strategy is stored.</p>
<p>If the indicator is used without any explicit instructions for the input data, then the closing price for the current market prices will be used.</p>
<p>When calling up the SMA(20) the smoothing average is calculated on the basis of the closing prices for the current chart price data (this is equivalent to SMA(close,20).</p>
<p>InSeries[0] = Close[0].</p>
<p>When calling up the SMA(high, 20) the high price values are loaded and used for the calculation of the smoothing average.</p>
<p>InSeries[0] = High[0].</p>
<p>This way you can select which data series should be used for the calculation of the indicator.</p>
<p><strong>double</strong> d = <strong>RSI</strong>(<strong>SMA</strong>(20), 14, 3)[0]; calculates the 14 period RSI using the SMA(20) as the input data series.
InSeries[0] = SMA(20)[0].</p>
<h3 id="usage_28">Usage</h3>
<pre><code class="cs">InSeries
InSeries[int barsAgo]
</code></pre>

<h3 id="example_26">Example</h3>
<pre><code class="cs">Print(&quot;The input data for the indicators are &quot; + Input[0]);
</code></pre>

<h2 id="lines">Lines</h2>
<h3 id="description_30">Description</h3>
<p>Lines is a collection that contains all <a href="#levelline"><em>LevelLine</em></a> objects of an indicator.</p>
<p>When a line object is added to the indicator using the <a href="#add"><em>Add()</em></a> method, this line is automatically added to the "lines" collection.</p>
<p>The order of the add commands determines how these lines are sorted. The first information request of Add() will create Lines[0], the next information request will be Lines[1] etc.</p>
<p>See <a href="#outputdescriptor"><em>OutputDescriptor</em></a>.</p>
<h3 id="usage_29">Usage</h3>
<pre><code class="cs">Lines[int index]
</code></pre>

<h3 id="example_27">Example</h3>
<pre><code class="cs">// Add &quot;using System.Drawing.Drawing2D;&quot; for DashStyle
protected override void OnInit()
{
Add(new LevelLine(Color.Blue, 70, &quot;Upper&quot;)); // saves into Lines[0]
Add(new LevelLine(Color.Blue, 30, &quot;Lower&quot;)); // saves into Lines[1]
}
protected override void OnCalculate()
{
// When the RSI is above 70, properties of the lines will be changed
if (RSI(14 ,3) &gt;= 70)
{
Lines[0].Width = 3;
Lines[0].Color = Color.Red;
Lines[0].DashStyle = DashStyle.Dot;
}
else
{
Lines[0].Width = 1;
Lines[0].Color = Color.Blue;
Lines[0].DashStyle = DashStyle.Solid;
}
}
</code></pre>

<h2 id="plotcolors">PlotColors</h2>
<h3 id="description_31">Description</h3>
<p>PlotColors is a collection that contains all color series of all plot objects.</p>
<p>When a plot is added using the <a href="#add"><em>Add()</em></a> method it automatically creates a color series object and is added to the PlotColors collection.</p>
<p>The order of the add commands determines how the plot colors are sorted. The first information request of Add() will create PlotColors[0], the following information request will create PlotColors[1] etc.</p>
<h3 id="usage_30">Usage</h3>
<pre><code class="cs">PlotColors[int PlotIndex][int barsAgo]
</code></pre>

<h3 id="more-information_20">More Information</h3>
<p>More information regarding the collection class:
<a href="http://msdn.microsoft.com/en-us/library/ybcx56wz%28v=vs.80%29.aspx"><em>http://msdn.microsoft.com/en-us/library/ybcx56wz%28v=vs.80%29.aspx</em></a></p>
<h3 id="example_28">Example</h3>
<pre><code class="cs">using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using AgenaTrader.API;
namespace AgenaTrader.UserCode
{
[Description(&quot;PlotColor Demo&quot;)]
public class PlotColorsDemo : UserIndicator
{
public DataSeries SMA20 { get {return Outputs[0];} }
public DataSeries SMA50 { get {return Outputs[1];} }
public DataSeries SMA100 { get {return Outputs[2];} }
private Pen pen;
protected override void OnInit()
{
// Set line strength (width) to 4
pen = new Pen(Color.Empty, 4);
// Add three plots with the defined line strength to the chart
Add(new OnPaint(pen, OutputSeriesDisplayStyle.LevelLine, &quot;SMA20&quot; )); //attached to PlotColors[0]
Add(new OnPaint(pen, OutputSeriesDisplayStyle.LevelLine, &quot;SMA50&quot; )); //attached to PlotColors[1]
Add(new OnPaint(pen, OutputSeriesDisplayStyle.LevelLine, &quot;SMA100&quot;)); //attached to PlotColors[2]
IsOverlay = true;
}
protected override void OnCalculate()
{
// Add values to the three plots
SMA20.Set (SMA(20) [0]);
SMA50.Set (SMA(50) [0]);
SMA100.Set(SMA(100)[0]);
// Change colors depending on the trend
if (IsSerieRising(Close))
{
PlotColors[0][0] = Color.LightGreen;
PlotColors[1][0] = Color.Green;
PlotColors[2][0] = Color.DarkGreen;
}
else if (IsSerieFalling(Close))
{
PlotColors[0][0] = Color.LightSalmon;
PlotColors[1][0] = Color.Red;
PlotColors[2][0] = Color.DarkRed;
}
else
{
PlotColors[0][0] = Color.LightGray;
PlotColors[1][0] = Color.Gray;
PlotColors[2][0] = Color.DarkGray;
}
}
}
}
</code></pre>

<h2 id="outputdescriptor">OutputDescriptor</h2>
<h3 id="description_32">Description</h3>
<p>OutputDescriptor is a collection that contains the plot objects of an indicator.</p>
<p>When a plot object is added to an indicator using the Add() method, it is also automatically added to the "plots" collection.</p>
<p>The order of the add commands determines how the plots are sorted. The first Add() information request will create Plots[0], the following information request will create OutputDescriptor[1] etc.</p>
<p>See <a href="#lines"><em>Lines</em></a>.</p>
<h3 id="usage_31">Usage</h3>
<pre><code class="cs">OutputDescriptor[int index]
</code></pre>

<h3 id="example_29">Example</h3>
<pre><code class="cs">protected override void OnInit()
{
Add(new OnPaint(Color.Blue, &quot;MySMA 20&quot;)); // saved to OutputDescriptor[0]
}
protected override void OnCalculate()
{
Value.Set(SMA(20)[0]);
// If the market price is above the SMA colorize it green, otherwise red
if (Close[0] &gt; SMA(20)[0])
    OutputDescriptor[0].PlotColor = Color.Green;
else
    OutputDescriptor[0].PlotColor = Color.Red;
}
</code></pre>

<h2 id="values">Values</h2>
<h3 id="description_33">Description</h3>
<p>Values is a collection that contains the data series objects of an indicator.</p>
<p>When a plot is added to an indicator using the Add() method, a value object is automatically created and added to the "values" collection.</p>
<p>The order of the add commands determines how the values are sorted. The first information request will create Values[0], the next information request will create Values[1] etc.</p>
<p><strong>Value</strong> is always identical to Values[0].</p>
<h3 id="usage_32">Usage</h3>
<pre><code class="cs">Outputs[int index]
Outputs[int index][int barsAgo]
</code></pre>

<h3 id="more-information_21">More Information</h3>
<p>The methods known for a collection, Set() Reset() and Count(), are applicable for values.</p>
<p>Information on the class collection:
<a href="http://msdn.microsoft.com/en-us/library/ybcx56wz%28v=vs.80%29.aspx"><em>http://msdn.microsoft.com/en-us/library/ybcx56wz%28v=vs.80%29.aspx</em></a></p>
<h3 id="example_30">Example</h3>
<pre><code class="cs">// Check the second indicator value of one bar ago and set the value of the current indicator value based on it.
if (Outputs[1][1] &lt; High[0] - Low[0])
Value.Set(High[0] - Low[0]);
else
Value.Set(High[0] - Close[0]);
</code></pre>

<h2 id="data-series">Data Series</h2>
<h3 id="description_34">Description</h3>
<p>Data series are interpreted as freely usable data storage containers for your programs. Additionally, they an integrated component of AgenaTrader that saves the price changes for individual bars. We will be focusing on the latter function here.
In the following section, the concept of data series will be explained in detail and understandably. All price data for the individual bars are organized and saved within data series.
The following are available:</p>
<p><a href="#open"><em>Open</em></a> <a href="#opens"><em>Opens</em></a></p>
<p><a href="#high"><em>High</em></a> <a href="#highs"><em>Highs</em></a></p>
<p><a href="#low"><em>Low</em></a> <a href="#lows"><em>Lows</em></a></p>
<p><a href="#close"><em>Close</em></a> <a href="#closes"><em>Closes</em></a></p>
<p><a href="#median"><em>Median</em></a> <a href="#medians"><em>Medians</em></a></p>
<p><a href="#typical"><em>Typical</em></a>  <a href="#typicals"><em>Typicals</em></a></p>
<p><a href="#weighted"><em>Weighted</em></a> <a href="#weighteds"><em>Weighteds</em></a></p>
<p><a href="#time"><em>Time</em></a> <a href="#times"><em>Times</em></a></p>
<p><a href="#timeframe"><em>TimeFrame</em></a> <a href="#timeframes"><em>TimeFrames</em></a></p>
<p><a href="#volume"><em>Volume</em></a> <a href="#volumes"><em>Volumes</em></a></p>
<h2 id="open">Open</h2>
<h3 id="description_35">Description</h3>
<p>Open is a <a href="#dataseries"><em>DataSeries</em></a> of the type <a href="#dataseries"><em>DataSeries</em></a>, in which the historical opening prices are saved.</p>
<h3 id="parameter_23">Parameter</h3>
<p>BarsAgo Index Value (see <a href="#bars"><em>Bars</em></a>)</p>
<h3 id="usage_33">Usage</h3>
<pre><code class="cs">Open
Open[int barsAgo]
</code></pre>

<h3 id="more-information_22">More Information</h3>
<p>The returned value is dependent upon the property of <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_31">Example</h3>
<pre><code class="cs">// Opening price for the current period
Print(Time[0] + &quot; &quot; + Open[0]);
// Opening price for the bars of 5 periods ago
Print(Time[5] + &quot; &quot; + Open[5]);
// Current value for the SMA 14 that is based on the opening prices (rounded)
Print(&quot;SMA(14) calculated using the opening prices: &quot; + Instrument.Round2TickSize(SMA(Open, 14)[0]));
</code></pre>

<h2 id="opens">Opens</h2>
<h3 id="description_36">Description</h3>
<p>Opens is an array of data series that contains all open data series.</p>
<p>This array is only useful or meaningful for indicators or strategies that use multiple data from multiple timeframes.
A new entry is entered into the array whenever a new timeframe is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>Opens[0] The open data series of the chart timeframe
Opens[1] The open data series of all bars in a daily timeframe
Opens[2] The open data series of all bars in a weekly timeframe</p>
<p>Opens[0][0] is equivalent to Open[0].</p>
<p>In addition, please see <a href="#multibars"><em>MultiBars</em></a> for more information.</p>
<h3 id="parameter_24">Parameter</h3>
<p>barsAgo Index value for the individual bars within the data series (see <a href="#bars"><em>Bars</em></a>)
barSeriesIndex Index value for the various timeframes</p>
<h3 id="usage_34">Usage</h3>
<pre><code class="cs">Opens[int barSeriesIndex]
Opens[int barSeriesIndex][int barsAgo]
</code></pre>

<h3 id="more-information_23">More Information</h3>
<p>The returned value is dependent upon the property of <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_32">Example</h3>
<p>See example: <a href="#multibars"><em>Multibars</em></a>.</p>
<h2 id="high">High</h2>
<h3 id="description_37">Description</h3>
<p>High is a <a href="#dataseries"><em>Data Series</em></a> of the type <a href="#dataseries"><em>Data Series</em></a>, in which the historical high prices are saved.</p>
<h3 id="parameter_25">Parameter</h3>
<p>barsAgo IndexValue (see <a href="#bars"><em>Bars</em></a>)</p>
<h3 id="usage_35">Usage</h3>
<pre><code class="cs">High
High[int barsAgo]
</code></pre>

<h3 id="more-information_24">More Information</h3>
<p>The returned value is dependent upon the property of <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_33">Example</h3>
<pre><code class="cs">// High values of the current period
Print(Time[0] + &quot; &quot; + High[0]);
// High values of the bar from 5 periods ago
Print(Time[5] + &quot; &quot; + High[5]);
// the current value for the SMA 14 calculated on the basis of the high prices
Print(&quot;SMA(14) Calculated using the high prices: &quot; + Instrument.Round2TickSize(SMA(High, 14)[0]));
</code></pre>

<h2 id="highs">Highs</h2>
<h3 id="description_38">Description</h3>
<p>Highs is an array of [<em>DataSeries</em>][1] that contains all high data series.</p>
<p>This array is only of value for indicators or strategies that use data from multiple timeframes.</p>
<p>A new entry is added to the array whenever a new time unit is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>Highs[0] the high data series of the chart timeframe
Highs[1] the high data series of all bars in a daily timeframe
Highs[2] the high data series of all bars in a weekly timeframe</p>
<p>Highs[0][0] is equivalent to High[0].</p>
<p>See <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_26">Parameter</h3>
<p>barsAgo Index value for the individual bars within the data series (see <a href="#bars"><em>Bars</em></a>)
barSeriesIndex Index value for the various timeframes</p>
<h3 id="usage_36">Usage</h3>
<pre><code class="cs">Highs[int barSeriesIndex]
Highs[int barSeriesIndex][int barsAgo]
</code></pre>

<h3 id="more-information_25">More Information</h3>
<p>The returned value is dependent upon the property of <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_34">Example</h3>
<p>Please see examples under <a href="#multibars"><em>Multibars</em></a>.</p>
<h2 id="low">Low</h2>
<h3 id="description_39">Description</h3>
<p>Low is a <a href="#dataseries"><em>DataSeries</em></a> of the type <a href="#dataseries"><em>DataSeries</em></a>, in which the historical low prices are saved.</p>
<h3 id="parameter_27">Parameter</h3>
<p>barsAgo IndexValue (see <a href="#bars"><em>Bars</em></a>)</p>
<h3 id="usage_37">Usage</h3>
<pre><code class="cs">Low
Low[int barsAgo]
</code></pre>

<h3 id="more-information_26">More Information</h3>
<p>The returned value is dependent upon the property of <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_35">Example</h3>
<pre><code class="cs">// Lowest value of the current period
Print(Time[0] + &quot; &quot; + Low[0]);
// Lowest value of the bar from 5 periods ago
Print(Time[5] + &quot; &quot; + Low[5]);
// The current value for the SMA 14 calculated on the basis of the low prices (smoothed)
Print(&quot;SMA(14) calculated using the high prices: &quot; + Instrument.Round2TickSize(SMA(Low, 14)[0]));
</code></pre>

<h2 id="lows">Lows</h2>
<h3 id="description_40">Description</h3>
<p>Lows is an array of [<em>DataSeries</em>][1] that contains all <a href="#low"><em>Low</em></a> data series.</p>
<p>This array is only of value to indicators or strategies that use data from multiple time units.</p>
<p>A new entry is added whenever a new time unit is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>Lows[0] the low data series for the chart timeframe
Lows[1] the low data series for all bars in a daily timeframe
Lows[2] the low data series for all bars in a weekly timeframe</p>
<p>Lows[0][0] is equivalent to Low[0].</p>
<p>See <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_28">Parameter</h3>
<p>barsAgo Index value for the individual bars within the data series
barSeriesIndex Index value for the various timeframes</p>
<h3 id="usage_38">Usage</h3>
<pre><code class="cs">Lows[int barSeriesIndex]
Lows[int barSeriesIndex][int barsAgo]
</code></pre>

<h3 id="more-information_27">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_36">Example</h3>
<p>See example <a href="#multibars"><em>Multibars</em></a>.</p>
<h2 id="close">Close</h2>
<h3 id="description_41">Description</h3>
<p>Close is a <a href="#dataseries"><em>DataSeries</em></a> of the type <a href="#dataseries"><em>DataSeries</em></a>, in which the historical closing prices are saved.</p>
<h3 id="parameter_29">Parameter</h3>
<p>barsAgo Index value (see <a href="#bars"><em>Bars</em></a>)</p>
<h3 id="usage_39">Usage</h3>
<pre><code class="cs">Close
Close[int barsAgo]
</code></pre>

<h3 id="more-information_28">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<p>Indicators are usually calculated using the closing prices.</p>
<h3 id="example_37">Example</h3>
<pre><code class="cs">// Closing price of the current period
Print(Time[0] + &quot; &quot; + Close[0]);
// Closing price of the bar from 5 periods ago
Print(Time[5] + &quot; &quot; + Close[5]);
// Current value for the SMA 14 based on the closing prices
Print(&quot;SMA(14) calculated using the closing prices: &quot; + Instrument.Round2TickSize(SMA(Close, 14)[0]));
// Close does not need to be mentioned since it is used by default
Print(&quot;SMA(14) calculated using the closing prices: &quot; + Instrument.Round2TickSize(SMA(14)[0]));
</code></pre>

<h2 id="closes">Closes</h2>
<h3 id="description_42">Description</h3>
<p>Closes is an array of [<em>DataSeries</em>][1] that contains all <a href="#low"><em>Low</em></a> data series.</p>
<p>This array is only of importance to indicators or strategies that use data from multiple time units.</p>
<p>A new entry is added to the array whenever a timeframe is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>Closes[0] the close data series of the chart timeframe
Closes[1] the close data series of all bars in a daily timeframe
Closes[2] the close data series of all bars in a weekly timeframe</p>
<p>Closes[0][0] is equivalent to Close[0].</p>
<p>See <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_30">Parameter</h3>
<p>barsAgo Index value of the individual bars within the data series
barSeriesIndex Index value for the various timeframes</p>
<h3 id="usage_40">Usage</h3>
<pre><code class="cs">Closes[int barSeriesIndex]
Closes[int barSeriesIndex][int barsAgo]
</code></pre>

<h3 id="more-information_29">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_38">Example</h3>
<p>See example <a href="#multibars"><em>Multibars</em></a>.</p>
<h2 id="median">Median</h2>
<h3 id="description_43">Description</h3>
<p>Median is a <a href="#dataseries"><em>DataSeries</em></a> of the type <a href="#dataseries"><em>DataSeries</em></a>, in which the historical median values are saved.</p>
<p>The median price of a bar is calculated using (high + low) / 2</p>
<p>See <a href="#typical"><em>Typical</em></a> &amp; <a href="#weighted"><em>Weighted</em></a>.</p>
<h3 id="parameter_31">Parameter</h3>
<p>barsAgo Index value (see <a href="#bars"><em>Bars</em></a>)</p>
<h3 id="usage_41">Usage</h3>
<pre><code class="cs">Median
Median[int barsAgo]
</code></pre>

<h3 id="more-information_30">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<p>Further information about median, typical und weighted:
<a href="http://blog.nobletrading.com/2009/12/median-price-typical-price-weighted.html"><em>http://blog.nobletrading.com/2009/12/median-price-typical-price-weighted.html</em></a></p>
<h3 id="example_39">Example</h3>
<pre><code class="cs">// Median price for the current period
Print(Time[0] + &quot; &quot; + Median[0]);
// Median price of the bar from 5 periods ago
Print(Time[5] + &quot; &quot; + Median[5]);
// Current value for the SMA 14 calculated using the median prices
Print(&quot;SMA(14) calculated using the median prices: &quot; + Instrument.Round2TickSize(SMA(Median, 14)[0]));
</code></pre>

<h2 id="medians">Medians</h2>
<h3 id="description_44">Description</h3>
<p>Medians is an array of [<em>DataSeries</em>][1] that contains all <a href="#median"><em>Median</em></a> data series.</p>
<p>This array is only of value to indicators or strategies that use data from multiple timeframes.</p>
<p>A new entry is added to the array whenever a new time frame is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>Medians[0] the median data series of the chart timeframe
Medians[1] the median data series of all bars in a daily timeframe
Medians[2] the median data series of all bars in a weekly timeframe</p>
<p>Medians[0][0] is equivalent to Medians[0].</p>
<p>See <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_32">Parameter</h3>
<p>barsAgo Index value for the individual bars within a data series
barSeriesIndex Index value for the various timeframes</p>
<h3 id="usage_42">Usage</h3>
<pre><code class="cs">Medians[int barSeriesIndex]
Medians[int barSeriesIndex][int barsAgo]
</code></pre>

<h3 id="more-information_31">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<p>Further information on median: <a href="http://www.investopedia.com/terms/m/median.asp">http://www.investopedia.com/terms/m/median.asp</a></p>
<h3 id="example_40">Example</h3>
<p>See example in <a href="#multibars"><em>Multibars</em></a>.</p>
<h2 id="typical">Typical</h2>
<h3 id="description_45">Description</h3>
<p>Typical is a <a href="#dataseries"><em>DataSeries</em></a> of the type <a href="#dataseries"><em>DataSeries</em></a>, in which the historical typical values are saved.</p>
<p>The typical price of a bar is calculated using (high + low + close) / 3.</p>
<p>See <a href="#median"><em>Median</em></a> and <a href="#weighted"><em>Weighted</em></a>.</p>
<h3 id="parameter_33">Parameter</h3>
<p>barsAgo Index value (see <a href="#bars"><em>Bars</em></a>)</p>
<h3 id="usage_43">Usage</h3>
<pre><code class="cs">Typical
Typical[int barsAgo]
</code></pre>

<h3 id="more-information_32">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<p>Further information on typical: <a href="https://technicianapp.com/resources/typical-price/"><em>https://technicianapp.com/resources/typical-price/</em></a></p>
<h3 id="example_41">Example</h3>
<pre><code class="cs">// Typical price for the current period
Print(Time[0] + &quot; &quot; + Typical[0]);
// Typical price of the bar from 5 periods ago
Print(Time[5] + &quot; &quot; + Typical[5]);
// Current value for the SMA 14 calculated using the typical price
Print(&quot;SMA(14) calculated using the typical price: &quot; + Instrument.Round2TickSize(SMA(Typical, 14)[0]));
</code></pre>

<h2 id="typicals">Typicals</h2>
<h3 id="description_46">Description</h3>
<p>Typicals is an array of <em>DataSeries</em> that contains all <a href="#typical"><em>Typical</em></a> data series.</p>
<p>This array is only of value to indicators and strategies that make use of multiple timeframes.</p>
<p>A new entry is added to the array whenever a new timeframe is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>Typicals[0] the typical data series of the chart timeframe
Typicals[1] the typical data series of all bars in a daily timeframe
Typicals[2] the typical data series of all bars in a weekly timeframe</p>
<p>Typicals[0][0] is equivalent to Typicals[0].</p>
<p>See <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_34">Parameter</h3>
<p>barsAgo Index value of the individual bars within a data series
barSeriesIndex Index value of the various timeframes</p>
<h3 id="usage_44">Usage</h3>
<pre><code class="cs">Typicals[int barSeriesIndex]
Typicals[int barSeriesIndex][int barsAgo]
</code></pre>

<h3 id="more-information_33">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_42">Example</h3>
<p>See example <a href="#multibars"><em>Multibars</em></a>.</p>
<h2 id="weighted">Weighted</h2>
<h3 id="description_47">Description</h3>
<p>Weighted is a <a href="#dataseries"><em>DataSeries</em></a> of the type <a href="#dataseries"><em>DataSeries</em></a>, in which the historical weighted values are saved.</p>
<p>The weighted price of a bar is calculated using the formula (high + low + 2*close) / 4 and then weighted on the closing price.</p>
<p>See also <a href="#median"><em>Median</em></a> and <a href="#typical"><em>Typical</em></a>.</p>
<h3 id="parameter_35">Parameter</h3>
<p>barsAgo Index value (see <a href="#bars"><em>Bars</em></a>)</p>
<h3 id="usage_45">Usage</h3>
<h2 id="weighted_1">Weighted</h2>
<pre><code class="cs">Weighted[int barsAgo]
</code></pre>

<h3 id="more-information_34">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<p>Information regarding weighted: <a href="http://www.stock-trading-infocentre.com/pivot-points.html"><em>http://www.stock-trading-infocentre.com/pivot-points.html</em></a></p>
<h3 id="example_43">Example</h3>
<pre><code class="cs">// Weighted price for the current period
Print(Time[0] + &quot; &quot; + Weighted[0]);
// Weighted price of the bar from 5 periods ago
Print(Time[5] + &quot; &quot; + Weighted[5]);
// Current value for the SMA 14 using the weighted price
Print(&quot;SMA(14) calculated using the weighted price: &quot; + Instrument.Round2TickSize(SMA(Weighted, 14)[0]));
</code></pre>

<h2 id="weighteds">Weighteds</h2>
<h3 id="description_48">Description</h3>
<p>Weighteds is an array of [<em>DataSeries</em>][1] that contains all <a href="#weighted"><em>Weighted</em></a> data series.</p>
<p>The array is only of value for indicators and strategies that use data from multiple timeframes.</p>
<p>A new entry is added to the array whenever a new timeframe is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>Weighteds[0] the weighted data series of the chart timeframe
Weighteds[1] the weighted data series of all bars in a daily timeframe
Weighteds[2] the weighted data series of all bars in a weekly timeframe</p>
<p>Weighteds[0][0] is equivalent to Weighteds[0].</p>
<p>See <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_36">Parameter</h3>
<p>barsAgo Index value of the individual bars within a data series
barSeriesIndex Index value for the various timeframes</p>
<h3 id="usage_46">Usage</h3>
<pre><code class="cs">Weighteds[int barSeriesIndex]
Weighteds[int barSeriesIndex][int barsAgo]
</code></pre>

<h3 id="more-information_35">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_44">Example</h3>
<p>See example under <a href="#multibars"><em>Multibars</em></a>.</p>
<h2 id="time">Time</h2>
<h3 id="description_49">Description</h3>
<p>Time is a <a href="#dataseries"><em>DataSeries</em></a> of the type <a href="#datetimeseries"><em>DateTimeSeries</em></a>, in which the timestamps of the individual bars are saved.</p>
<h3 id="parameter_37">Parameter</h3>
<p>barsAgo Index value (see <a href="#bars"><em>Bars</em></a>)</p>
<h3 id="usage_47">Usage</h3>
<pre><code class="cs">Time
Time[int barsAgo]
</code></pre>

<h3 id="more-information_36">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_45">Example</h3>
<pre><code class="cs">// Timestamp of the current period
Print(Time[0]);
// Timestamp of the bar from 5 periods ago
Print(Time[5]);
</code></pre>

<h2 id="times">Times</h2>
<h3 id="description_50">Description</h3>
<p>Times is an array of <a href="#dataseries"><em>DataSeries</em></a> that contains all <a href="#time"><em>Time</em></a> data series.</p>
<p>This array is only of value to indicators and strategies that make use of multiple timeframes.
A new entry is added to the array whenever a new timeframe is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>Times[0] the time data series of the chart timeframe
Times[1] the time data series of all bars in a daily timeframe
Times[2] the time data series of all bars in a weekly timeframe</p>
<p>Times[0][0] is equivalent to Times[0].</p>
<p>See <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_38">Parameter</h3>
<p>barsAgo Index value for the individual bars within a data series
barSeriesIndex Index value for the various timeframes</p>
<h3 id="usage_48">Usage</h3>
<pre><code class="cs">Times[int barSeriesIndex]
Times[int barSeriesIndex][int barsAgo]
</code></pre>

<h3 id="more-information_37">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_46">Example</h3>
<p>See example <a href="#multibars"><em>Multibars</em></a>.</p>
<h2 id="volume">Volume</h2>
<h3 id="description_51">Description</h3>
<p>Volume is a <a href="#dataseries"><em>DataSeries</em></a> of the type <a href="#dataseries"><em>DataSeries</em></a>, in which the historical volume information is saved.</p>
<h3 id="parameter_39">Parameter</h3>
<p>barsAgo Index value (see <a href="#bars"><em>Bars</em></a>)</p>
<h3 id="usage_49">Usage</h3>
<p>Volume</p>
<p>Volume[<strong>int</strong> barsAgo]</p>
<h3 id="more-information_38">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<p>The value returned by the <a href="#vol"><em>VOL()</em></a> indicator is identical with the volume described here;
for example, Vol()[3] will have the same value as Volume[3].</p>
<h3 id="example_47">Example</h3>
<pre><code class="cs">// Volume for the current period
Print(Time[0] + &quot; &quot; + Volume[0]);
// Volume of the bar from 5 periods ago
Print(Time[5] + &quot; &quot; + Volume[5]);
// Current value for the SMA 14 calculated using the volume
Print(&quot;SMA(14) calculated using the volume: &quot; + Instrument.Round2TickSize(SMA(Volume, 14)[0]));
</code></pre>

<h2 id="volumes">Volumes</h2>
<h3 id="description_52">Description</h3>
<p>Volumes is an array of <a href="#dataseries"><em>DataSeries</em></a> that contains all <a href="#volume"><em>Volume</em></a> data series.</p>
<p>This array is only of value for indicators or strategies that use data from multiple timeframes.</p>
<p>A new entry is added to the array whenever a new timeframe is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>Volumes[0] the volume data series of the chart timeframe
Volumes[1] the volume data series of all bars in the daily timeframe
Volumes[2] the volume data series of all bars in the weekly timeframe</p>
<p>Volumes[0][0] is equivalent to Volumes[0].</p>
<p>See <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_40">Parameter</h3>
<p>barsAgo Index value of the individual bars within a data series</p>
<p>barSeriesIndex Index value of the various timeframes</p>
<h3 id="usage_50">Usage</h3>
<pre><code class="cs">Volumes[int barSeriesIndex]
Volumes[int barSeriesIndex][int barsAgo]
</code></pre>

<h3 id="more-information_39">More Information</h3>
<p>The returned value is dependent upon the property <a href="#calculateonclosedbar"><em>CalculateOnClosedBar</em></a>.</p>
<h3 id="example_48">Example</h3>
<p>See example <a href="#multibars"><em>Multibars</em></a>.</p>
<h2 id="timeframe">TimeFrame</h2>
<h3 id="description_53">Description</h3>
<p>TimeFrame is a timeframe object. This property is used to read the current TimeFrame and not to set it.</p>
<h3 id="usage_51">Usage</h3>
<pre><code class="cs">TimeFrame
</code></pre>

<h2 id="timeframes">TimeFrames</h2>
<h3 id="description_54">Description</h3>
<p>TimeFrames is an array of timeframe objects that contains a timeframe object for each individual bar object.</p>
<p>This array is only of value for indicators or strategies that use data from multiple timeframes.</p>
<p>A new entry is added to the array whenever a new timeframe is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>TimeFrames [0] Timeframe of the primary data series (chart timeframe)
TimeFrames [1] <strong>Print</strong>(TimeFrames[1]); // returns "1 Day"
TimeFrames [2] <strong>Print</strong>(TimeFrames[2]); // returns "1 Week"</p>
<p>TimeFrames [0] is equivalent to <a href="#timeframe"><em>TimeFrame</em></a>.</p>
<p>See <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_41">Parameter</h3>
<p>barSeriesIndex Index value for the various timeframes</p>
<h3 id="usage_52">Usage</h3>
<pre><code class="cs">TimeFrames [int barSeriesIndex]
</code></pre>

<h3 id="example_49">Example</h3>
<pre><code class="cs">if (ProcessingBarSeriesIndex == 0 &amp;&amp; ProcessingBarIndex == 0)
for (int i = BarsArray.Count-1; i &gt;= 0; i--)
Print(&quot;The Indicator &quot; + this.Name + &quot; uses Bars of the Timeframe &quot; + TimeFrames[i]);
</code></pre>

<h2 id="instruments">Instruments</h2>
<p>The term "instrument" denotes a tradable value such as a stock, ETF, future etc.</p>
<p>An instrument has various properties that can be used in AgenaScripts created by the user:</p>
<p><a href="#instrumentcompare"><em>Instrument.Compare</em></a></p>
<p><a href="#instrumentcurrency"><em>Instrument.Currency</em></a></p>
<p><a href="#instrumentdigits"><em>Instrument.Digits</em></a></p>
<p><a href="#instrumentetf"><em>Instrument.ETF</em></a></p>
<p><a href="#instrumentexchange"><em>Instrument.Exchange</em></a></p>
<p><a href="#instrumentexpiry"><em>Instrument.Expiry</em></a></p>
<p><a href="#instrumentgetcurrencyfactor"><em>Instrument.GetCurrencyFactor</em></a></p>
<p><a href="#instrumentinstrumenttype"><em>Instrument.InstrumentType</em></a></p>
<p><a href="#instrumentmainsector"><em>Instrument.MainSector</em></a></p>
<p><a href="#instrumentmargin"><em>Instrument.Margin</em></a></p>
<p><a href="#instrumentname"><em>Instrument.Name</em></a></p>
<p><a href="#instrumentpointvalue"><em>Instrument.PointValue</em></a></p>
<p><a href="#instrumentround2ticksize"><em>Instrument.Round2TickSize</em></a></p>
<p><a href="#instrumentsymbol"><em>Instrument.Symbol</em></a></p>
<p><a href="#instrumentticksize"><em>Instrument.TickSize</em></a></p>
<p>With the <strong>OnCalculate()</strong> method you can use any properties you wish without having to test for a null reference.
As soon as the <strong>OnCalculate()</strong> function is called up by AgenaScript, an object will become available. If you wish to use these properties outside of <strong>OnCalculate()</strong>, you should first perform a test for null references using <strong>if</strong> (Bars != <strong>null</strong>)</p>
<h2 id="instrumentcompare">Instrument.Compare</h2>
<h3 id="description_55">Description</h3>
<p>The Instrument.Compare function compares two market prices whilst taking into account the correct number of decimal points. The smallest possible price change is displayed by the value TickSize. This function simplifies the otherwise time-consuming comparison using floating-point operations.</p>
<h3 id="parameter_42">Parameter</h3>
<p>double value1
double value2</p>
<h3 id="return-value_28">Return value</h3>
<p>Type int</p>
<p>1 - value1 is bigger than value2
-1 - value1 is smaller than value2
0 - value1 and value2 are equal</p>
<h3 id="usage_53">Usage</h3>
<pre><code class="cs">Instrument.Compare(double Value1, double Value2)
</code></pre>

<h3 id="more-information_40">More Information</h3>
<p><strong>Be aware this function compares prices based on TickSize.</strong> If the ticksize of your instrument is 0.01 these prices will be rounded and compared on 2 decimal digits. If you want a regular comparation of two numbers, you should use the operator "greater than" (&gt;) or the operator "smaller than" (&lt;).</p>
<p>More infomation about <a href="https://msdn.microsoft.com/en-us//library/75ks3aby(v=vs.110).aspx">math.round()</a></p>
<p>If the tick size is 0,00001 – as it usually is with FX values – then the following will be displayed:</p>
<p>Compare(2, 1.99999) a 1, meaning 2 is bigger than 1.99999
Compare(2, 2.000001) a 0, meaning the values are equal
Compare(2, 1.999999) a 0, meaning the values are equal
Compare(2, 2.00001) a -1, meaning 2 is smaller than 2.00001</p>
<h3 id="example_50">Example</h3>
<pre><code class="cs">Print(Instrument.Compare(2, 1.999999));
</code></pre>

<h2 id="instrumentcurrency">Instrument.Currency</h2>
<h3 id="description_56">Description</h3>
<p>Instrument.Currency outputs a currency object that contains the corresponding currency in which the instrument is traded.</p>
<h3 id="parameter_43">Parameter</h3>
<p>None</p>
<h3 id="return-value_29">Return Value</h3>
<p>A constant of the type "public enum currencies"</p>
<h3 id="usage_54">Usage</h3>
<p>Instrument.Currency</p>
<h3 id="more-information_41">More Information</h3>
<p>The common currencies are: AUD, CAD, EUR, GBP, JPY or USD.</p>
<h3 id="example_51">Example</h3>
<pre><code class="cs">Print(Instrument.Name + &quot; is traded in &quot; + Instrument.Currency);
</code></pre>

<h2 id="instrumentdigits">Instrument.Digits</h2>
<h3 id="description_57">Description</h3>
<p>Instrument.Digits outputs the number of decimal points in which the market price of the instrument is traded.</p>
<h3 id="parameter_44">Parameter</h3>
<p>none</p>
<h3 id="return-value_30">Return Value</h3>
<p>int Digits</p>
<h3 id="usage_55">Usage</h3>
<p>Instrument.Digits</p>
<h3 id="more-information_42">More Information</h3>
<p>Stocks are usually traded to two decimal points. Forex can be traded (depending on the data provider) with 4 or 5 decimal places.</p>
<p>This function is especially useful when formatting the output of various instruments that need rounding. Also see <a href="#ticksize"><em>TickSize</em></a> and <a href="#instrumentround2ticks"><em>Instrument.Round2Ticks</em></a>, <a href="#instrumentround2ticksize"><em>Instrument.Round2TickSize</em></a>.</p>
<p>More information can be found here: <em>Formatting of Numbers</em>.</p>
<h3 id="example_52">Example</h3>
<pre><code class="cs">Print(&quot;The value of &quot; +Instrument.Name + &quot; is noted with a precision of &quot; + Instrument.Digits +&quot; Decimal points.&quot;);
</code></pre>

<h2 id="instrumentetf">Instrument.ETF</h2>
<h3 id="description_58">Description</h3>
<p>Instrument.ETF is used to differentiate between a stock and an ETF. This is necessary since ETFs are considered to be „stocks" by some exchanges.</p>
<h3 id="parameter_45">Parameter</h3>
<p>none</p>
<h3 id="return-value_31">Return Value</h3>
<p>Type bool</p>
<h3 id="usage_56">Usage</h3>
<p>Instrument.ETF</p>
<h3 id="more-information_43">More Information</h3>
<p>What is an ETF?</p>
<p>Wikipedia: <a href="http://de.wikipedia.org/wiki/Exchange-traded_fund*"><em>http://de.wikipedia.org/wiki/Exchange-traded_fund</em></a></p>
<h3 id="example_53">Example</h3>
<pre><code class="cs">if (Instrument.InstrumentType == InstrumentType.Stock)
if (Instrument.ETF)
Print(&quot;The value is an ETF.&quot;);
else
Print(&quot;The value is a stock.&quot;);
</code></pre>

<h2 id="instrumentexchange">Instrument.Exchange</h2>
<h3 id="description_59">Description</h3>
<p>Instrument.Exchange outputs the description/definition of the current exchange for the current instrument.</p>
<h3 id="parameter_46">Parameter</h3>
<p>none</p>
<h3 id="return-value_32">Return Value</h3>
<p>An exchange object of the type "public enum exchanges"</p>
<h3 id="usage_57">Usage</h3>
<p>Instrument.Exchange</p>
<h3 id="more-information_44">More Information</h3>
<p>An overview of various exchange: <em>https://en.wikipedia.org/wiki/List_of_stock_exchanges</em></p>
<h3 id="example_54">Example</h3>
<pre><code class="cs">Print(&quot;The instrument &quot; + Instrument.Name +&quot; is traded on the &quot; + Instrument.Exchange + &quot; exchange.&quot;);
</code></pre>

<h2 id="instrumentexpiry">Instrument.Expiry</h2>
<h3 id="description_60">Description</h3>
<p>Instrument.Expiry outputs the date (month and year) of the expiry of a financial instrument. Only derivative instruments such as options or futures will have an expiry date.</p>
<h3 id="parameter_47">Parameter</h3>
<p>None</p>
<h3 id="return-value_33">Return Value</h3>
<p>Type DateTime</p>
<p>For instruments without an expiry date the returned value is set to DateTime.MaxValue(= 31.12.9999 23.59:59)</p>
<h3 id="usage_58">Usage</h3>
<p>Instrument.Expiry</p>
<h3 id="more-information_45">More Information</h3>
<p>The expiry date (expiry) can also be seen within the Instrument Escort:</p>
<p><img alt="Instrument.Expiry" src="../media/Expiry.jpg" /></p>
<h3 id="example_55">Example</h3>
<pre><code class="cs">Print(&quot;The instrument &quot; + Instrument.Name +&quot; will expire on &quot; + Instrument.Expiry);
</code></pre>

<h2 id="instrumentgetcurrencyfactor">Instrument.GetCurrencyFactor</h2>
<h3 id="description_61">Description</h3>
<p>Instrument.GetCurrencyFactor returns a conversion factor that can be used to convert an instrument's currency to the account's currency.</p>
<h3 id="parameter_48">Parameter</h3>
<p>Type Currencies</p>
<h3 id="return-value_34">Return Value</h3>
<p>Type double</p>
<h3 id="usage_59">Usage</h3>
<p>Instrument.GetCurrencyFactor(Currencies)</p>
<h3 id="more-information_46">More Information</h3>
<p>Common currencies are.B. AUD, CAD, EUR, GBP, JPY oder USD.</p>
<h3 id="example_56">Example</h3>
<pre><code class="cs">Protected override void OnCalculate()
{
   double currFactor = Instrument.GetCurrencyFactor(Account.Currency);
   Print(Close[0] + &quot; in &quot; + Instrument.Currency.ToString() + &quot; = &quot; + (Close[0] * currFactor) + &quot; in &quot; + Account.Currency.ToString());
}
</code></pre>

<h2 id="instrumentinstrumenttype">Instrument.InstrumentType</h2>
<h3 id="description_62">Description</h3>
<p>Instrument.InstrumentType outputs a type object of the trading instrument.</p>
<h3 id="parameter_49">Parameter</h3>
<p>none</p>
<h3 id="return-value_35">Return Value</h3>
<p>Object of the type "public enum instrument"</p>
<h3 id="usage_60">Usage</h3>
<p>Instrument.InstrumentType</p>
<h3 id="more-information_47">More Information</h3>
<p>Potential values are: future, stock, index, currency, option, CFD and unknown.</p>
<p>There is no ETF type. ETFs are considered to be of the type "stock" – see <a href="#instrumentetf"><em>Instrument.ETF</em></a>.</p>
<p>The instrument type can also be viewed within the Instrument Escort:</p>
<p><img alt="Instrument.InstrumentType" src="../media/InstrumentTypeFGBL.jpg" /></p>
<h3 id="example_57">Example</h3>
<pre><code class="cs">Print(&quot;The instrument &quot; + Instrument.Name + &quot; is of the type &quot; + Instrument.InstrumentType);
</code></pre>

<h2 id="instrumentmainsector">Instrument.MainSector</h2>
<h3 id="description_63">Description</h3>
<p>Instrument.MainSector returns the main sector of the trading instrument.</p>
<h3 id="parameter_50">Parameter</h3>
<p>none</p>
<h3 id="return-value_36">Return Value</h3>
<p>String</p>
<h3 id="usage_61">Usage</h3>
<p>Instrument.MainSector</p>
<h3 id="more-information_48">More Information</h3>
<p>The main sector is also visible in the instrument escort:
<img alt="Instrument.InstrumentType" src="../media//InstrumentTypeFGBL.jpg" /></p>
<h3 id="example_58">Example</h3>
<pre><code class="cs">Print(&quot;Das Instrument &quot; + Instrument.Name + &quot; ist im Sektor &quot; + Instrument.MainSector + &quot; tätig.&quot;);
</code></pre>

<h2 id="instrumentmargin">Instrument.Margin</h2>
<h3 id="description_64">Description</h3>
<p>Instrument.MainSector returns the required margin of the trading instrument.</p>
<h3 id="parameter_51">Parameter</h3>
<p>none</p>
<h3 id="return-value_37">Return Value</h3>
<p>int</p>
<h3 id="usage_62">Usage</h3>
<p>Instrument.Margin</p>
<h3 id="more-information_49">More Information</h3>
<p>Margin is also visible in the instrument escort:
<img alt="Instrument.InstrumentType" src="../media/MarginFGBL.jpg" /></p>
<h3 id="example_59">Example</h3>
<pre><code class="cs">Print(&quot;Das Instrument &quot; + Instrument.Name + &quot; has a margin of &quot; + Instrument.Margin);
</code></pre>

<h2 id="instrumentname">Instrument.Name</h2>
<h3 id="description_65">Description</h3>
<p>Instrument.Name outputs the name/description of the trading instrument.</p>
<h3 id="parameter_52">Parameter</h3>
<p>none</p>
<h3 id="return-value_38">Return Value</h3>
<p>Type string</p>
<h3 id="usage_63">Usage</h3>
<p>Instrument.Name</p>
<h3 id="more-information_50">More Information</h3>
<p>The instrument name can also be seen within the Instrument Escort:</p>
<p><img alt="Instrument.Name" src="../media/Name_Fdax.jpg" /></p>
<h3 id="example_60">Example</h3>
<pre><code class="cs">Print(&quot;The currently loaded instrument inside the chart is named &quot; + Instrument.Name);
</code></pre>

<h2 id="instrumentpointvalue">Instrument.PointValue</h2>
<h3 id="description_66">Description</h3>
<p>Instrument.PointValue outputs the monetary value for a full point movement of the instrument.</p>
<h3 id="parameter_53">Parameter</h3>
<p>none</p>
<h3 id="return-value_39">Return Value</h3>
<p>double – point value</p>
<h3 id="usage_64">Usage</h3>
<p>Instrument.PointValue</p>
<h3 id="more-information_51">More Information</h3>
<p><strong>Example for various point values</strong> (per amount, CFD, futures contract, lot etc.)</p>
<p>Stock: generally 1.00 Euro or 1.00 USD.
EUR/USD: 100,000 USD
DAX future: 25.00 Euro</p>
<p><strong>Tick Value</strong></p>
<p>The tick value can be calculated by multiplying the point value with the tick size.</p>
<p>For example, the E-mini S&amp;P 500 has a point value of $50. The tick size equals 0.25. This means that there are 4 ticks in one full point for the E-mini S&amp;P 500.
Since 50 * 0.25 = 50/4 this means that the tick value is $12.50.</p>
<p>The point value can also be viewed within the Instrument Escort:</p>
<p><img alt="Instrument.PointValue" src="../media/Fdax_PointValue.jpg" /></p>
<h3 id="example_61">Example</h3>
<pre><code class="cs">Print(&quot;When &quot; + Instrument.Name + &quot; rises for one full point then this is equal to &quot; + Instrument.PointValue + &quot; &quot; + Instrument.Currency);
</code></pre>

<h2 id="instrumentround2ticksize">Instrument.Round2TickSize</h2>
<h3 id="description_67">Description</h3>
<p>The function Instrument.Round2TickSize rounds the supplied market price to the smallest value divisible by the tick size of the instrument.</p>
<h3 id="parameter_54">Parameter</h3>
<p>double – market value</p>
<h3 id="return-value_40">Return value</h3>
<p>double</p>
<h3 id="usage_65">Usage</h3>
<pre><code class="cs">Instrument.Round2TickSize(double MarketPrice)
</code></pre>

<h3 id="more-information_52">More Information</h3>
<p>The number of decimal places to which the price is rounded depends on the instrument.
If, for example, an instrument is a stock, then the rounding will be performed to 2 decimal places. For a Forex instrument, it may be carried out to 4 or 5 decimal places.</p>
<p>See <a href="#ticksize"><em>TickSize</em></a> and <a href="#instrumentdigits"><em>Instrument.Digits</em></a>.</p>
<p>Example of professional <a href="#formatting"><em>Formatting</em></a>, <em>Formatting of Numbers</em>.</p>
<h3 id="example_62">Example</h3>
<pre><code class="cs">double Price = 12.3456789;
Print(Price + &quot; rounded for a &quot; + Instrument.Name + &quot; valid value is &quot; + Instrument.Round2TickSize(Price));
</code></pre>

<h2 id="instrumentsymbol">Instrument.Symbol</h2>
<h3 id="description_68">Description</h3>
<p>Instrument.Symbol outputs the symbol that identifies the trading instrument within AgenaTrader. Depending on the symbol, the mappings for the various data feed providers and brokers will be managed in different ways.</p>
<h3 id="parameter_55">Parameter</h3>
<p>none</p>
<h3 id="return-value_41">Return value</h3>
<p>Type string</p>
<h3 id="usage_66">Usage</h3>
<p>Instrument.Symbol</p>
<h3 id="more-information_53">More Information</h3>
<p>By using symbols, identical stocks being traded on different exchanges can be identified and separated from each other. The symbol BMW.DE is the BMW stock on the XETRA exchange. BMW.CFG is the CFD for the BMW stock.</p>
<p>The instrument symbol can also be viewed within the Instrument Escort:</p>
<p><img alt="Instrument.Symbol" src="../media/Fdax_Symbol.jpg" /></p>
<h3 id="example_63">Example</h3>
<pre><code class="cs">Print(&quot;The instrument currently loaded within the chart has the symbol: &quot; + Instrument.Symbol);
</code></pre>

<h2 id="instrumentticksize">Instrument.TickSize</h2>
<h3 id="description_69">Description</h3>
<p>The tick size is the smallest measurable unit that a financial instrument can move. This is usually called 1 tick.</p>
<h3 id="parameter_56">Parameter</h3>
<p>none</p>
<h3 id="return-value_42">Return Value</h3>
<p>double</p>
<h3 id="usage_67">Usage</h3>
<p>Instrument.TickSize or simply TickSize</p>
<h3 id="more-information_54">More Information</h3>
<p>The keyword <a href="#ticksize"><em>TickSize</em></a> is equivalent to Instrument.TickSize. Both information requests will produce the same value and are thus interchangeable.</p>
<h3 id="example_64">Example</h3>
<p>Stock: 0.01
ES future: 0.25
EUR/USD: 0.00001</p>
<p>See <a href="#instrumentpointvalue"><em>Instrument.PointValue</em></a> and <a href="#instrumentdigits"><em>Instrument.Digits</em></a>.</p>
<p>Examples of professional <a href="#formatting"><em>Formatting</em></a>, <em>Formatting of Numbers</em>.</p>
<h3 id="example_65">Example</h3>
<pre><code class="cs">Print(&quot;The value of &quot; + Instrument.Name + &quot; can change for a minimum of &quot; + Instrument.TickSize + &quot; Tick(s).&quot;);
</code></pre>

<h2 id="multibars">Multibars</h2>
<h3 id="description_70">Description</h3>
<p>An indicator or a strategy will always have the same underlying timeframe-units as those units being displayed within the chart. The values of an SMA(14) indicator displayed in a 5 minute chart will be calculated based on the last fourteen 5 minute bars. A daily chart, on the other hand, would use the closing prices of the past 14 days in order to calculate this value.
The same method applies for your self-programmed indicators. A 5 minute chart will call up the <a href="#oncalculate"><em>OnCalculate()</em></a> for each 5 minute bar.
If you want your self-created indicator to use a different timeframe, this is possible using multibars.</p>
<h3 id="example_66">Example</h3>
<pre><code class="cs">using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Linq;
using System.Xml;
using System.Xml.Serialization;
using AgenaTrader.API;
using AgenaTrader.Custom;
using AgenaTrader.Plugins;
using AgenaTrader.Helper;
namespace AgenaTrader.UserCode
{
    [Description(&quot;Multibar Demo&quot;)]
    // The indicator requires daily and weekly data
    [TimeFrameRequirements(&quot;1 Day&quot;, &quot;1 Week&quot;)]
    public class MultiBarDemo : UserIndicator
    {
        private static readonly TimeFrame TF_Day = new TimeFrame(DatafeedHistoryPeriodicity.Day, 1);
        private static readonly TimeFrame TF_Week = new TimeFrame(DatafeedHistoryPeriodicity.Week, 1);

        protected override void OnBarsRequirements()
        {
            Add(TF_Day);
            Add(TF_Week);
        }

        protected override void OnInit()
        {
            CalculateOnClosedBar = true;
        }
        protected override void OnCalculate()
        {
            // The current value for the SMA 14 in the timeframe of the chart
            Print(&quot;TF0: &quot; + SMA(Closes[0], 14)[0]);
            // The current value for the SMA 14 in a daily timeframe
            Print(&quot;TF1: &quot; + SMA(Closes[1], 14)[0]);
            // Current value for the SMA 14 in a weekly timeframe
            Print(&quot;TF2: &quot; + SMA(Closes[2], 14)[0]);
        }
    }
}
</code></pre>

<h3 id="additional-notes">Additional Notes</h3>
<p>When using additional timeframes, a further entry with the respective data series for the bars of the new timeframe will be added to the arrays <a href="#opens"><em>Opens</em></a>, <a href="#highs"><em>Highs</em></a>, <a href="#lows"><em>Lows</em></a>, <a href="#closes"><em>Closes</em></a>, <a href="#medians"><em>Medians</em></a>, <a href="#typicals"><em>Typicals</em></a>, <a href="#weighteds"><em>Weighteds</em></a>, <a href="#times"><em>Times</em></a> and <a href="#volumes"><em>Volumes</em></a>. The indexing will occur in the order of the addition of the new timeframes.
Closes[0][0] is equivalent to Close[0].
Closes[1][0] equals the current closing price for the daily data series
Closes[2][0] equals the current closing price for the weekly data series</p>
<p>"Closes" is, of course, interchangeable with Opens, Highs, Lows etc.</p>
<p>See <a href="#processingbarindexes"><em>ProcessingBarIndexes</em></a>, <a href="#processingbarseriesindex"><em>ProcessingBarSeriesIndex</em></a>, <a href="#timeframes"><em>TimeFrames</em></a>, <a href="#timeframerequirements"><em>TimeFrameRequirements</em></a>.</p>
<p>Additional syntax methods are available for multibars:</p>
<pre><code class="cs">// Declare the variable TF_DAY and define it
private static readonly TimeFrame TF_Day = new TimeFrame(DatafeedHistoryPeriodicity.Day, 1);
private static readonly TimeFrame TF_Week = new TimeFrame(DatafeedHistoryPeriodicity.Week, 1);
// The following instruction is identical to double d = Closes[1][0];
double d = MultiBars.GetBarsItem(TF_Day).Close[0];
// The following instruction is identical to double w = Closes[2][0];
double w = MultiBars.GetBarsItem(TF_Week).Close[0];
</code></pre>

<h2 id="processingbarindexes">ProcessingBarIndexes</h2>
<h3 id="description_71">Description</h3>
<p>ProcessingBarIndexes is an array of int values that contains the number of <a href="#processingbarindex"><em>ProcessingBarIndex</em></a> for each bar.</p>
<p>This array is only of value for indicators or strategies that use data from multiple timeframes.</p>
<p>A new entry is added to the array whenever a new timeframe is added to an indicator or strategy.</p>
<p>With <strong>[TimeFrameRequirements(("1 Day"), ("1 Week"))]</strong> the array will contain 3 entries:</p>
<p>ProcessingBarIndexes[0] Current bar for the primary data series (chart timeframe)
ProcessingBarIndexes[1] Current bar for the daily bars
ProcessingBarIndexes[2] Current bar for the weekly bars</p>
<p>ProcessingBarIndexes[0] is equivalent to <a href="#processingbarindex"><em>ProcessingBarIndex</em></a>.</p>
<p>Also see <a href="#multibars"><em>MultiBars</em></a>.</p>
<h3 id="parameter_57">Parameter</h3>
<p>barSeriesIndex Index value for the various timeframes</p>
<h3 id="usage_68">Usage</h3>
<pre><code class="cs">ProcessingBarIndexes[int barSeriesIndex]
</code></pre>

<h3 id="example_67">Example</h3>
<pre><code class="cs">//Ensure that a minimum of 20 bars is loaded
for (int i=0; i&lt;ProcessingBarIndexes.Count; i++)
if (ProcessingBarIndexes[i] &lt; 20) return;
</code></pre>

<h2 id="processingbarseriesindex">ProcessingBarSeriesIndex</h2>
<h3 id="description_72">Description</h3>
<p>Within a multibars script, multiple bars objects are available. The OnCalculate() method
will therefore also be called up for every bar within your script. In order to include/exclude events of specific data series, you can use the ProcessingBarSeriesIndex property.</p>
<p>ProcessingBarSeriesIndex is only of value for indicators or strategies that use data from multiple timeframes.
With <strong>[TimeFrameRequirements("1 Day", "1 Week")]</strong> two timeframes will be added to the primary chart timeframe.</p>
<p>If OnCalculate() is called up by the primary data series, then ProcessingBarSeriesIndex will equal zero. If OnCalculate() is called up by the daily bars, then ProcessingBarSeriesIndex will equal 1. Weekly bars will have a value of 2.</p>
<p>See <a href="#multibars"><em>Multibars</em></a> and <a href="#processingbarindexes"><em>ProcessingBarIndexes</em></a>.</p>
<h3 id="parameter_58">Parameter</h3>
<p>none</p>
<h3 id="usage_69">Usage</h3>
<p>ProcessingBarSeriesIndex</p>
<h3 id="more-information_55">More Information</h3>
<p>Within a script that only works with primary timeframes, the value will always equal zero.</p>
<h3 id="example_68">Example</h3>
<pre><code class="cs">// To demonstrate the methodology
// set CalculateOnClosedBar=false
Print(Time[0] + &quot; &quot; + ProcessingBarSeriesIndex);
// Calculate only for the chart timeframe
protected override void OnCalculate()
{
if (ProcessingBarSeriesIndex &gt; 0) return;
// Logic for the primary data series
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../events/" class="btn btn-neutral float-right" title="Events">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Lets start"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/AgenaTrader/AgenaScript-documentation" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../events/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
